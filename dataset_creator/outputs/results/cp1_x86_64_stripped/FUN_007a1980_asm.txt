007a1980 ENDBR64
007a1984 PUSH R12
007a1986 PUSH RBP
007a1987 MOV RBP,RSI
007a198a PUSH RBX
007a198b MOV EAX,dword ptr [RDI]
007a198d MOV RBX,RDI
007a1990 AND EAX,0x8000
007a1995 JNZ 0x007a19cb
007a1997 MOV R12,qword ptr FS:[0x10]
007a19a0 MOV RDI,qword ptr [RDI + 0x88]
007a19a7 CMP qword ptr [RDI + 0x8],R12
007a19ab JZ 0x007a19c7
007a19ad MOV EDX,0x1
007a19b2 CMPXCHG.LOCK dword ptr [RDI],EDX
007a19b6 JNZ 0x007a1ab8
007a19bc MOV RDI,qword ptr [RBX + 0x88]
007a19c3 MOV qword ptr [RDI + 0x8],R12
007a19c7 ADD dword ptr [RDI + 0x4],0x1
007a19cb XOR ECX,ECX
007a19cd MOV EDX,0x1
007a19d2 XOR ESI,ESI
007a19d4 MOV RDI,RBX
007a19d7 CALL 0x006fe4a0
007a19dc MOV EDX,dword ptr [RBX]
007a19de MOV R12D,EDX
007a19e1 AND R12D,0x100
007a19e8 JZ 0x007a1a30
007a19ea CMP RAX,-0x1
007a19ee JZ 0x007a1a78
007a19f4 MOV ESI,dword ptr [RBX + 0xc0]
007a19fa TEST ESI,ESI
007a19fc JLE 0x007a1a98
007a1a02 MOV qword ptr [RBP],RAX
007a1a06 MOV RDI,qword ptr [RBX + 0x98]
007a1a0d CALL 0x00701fb0
007a1a12 MOV EDX,dword ptr [RBX]
007a1a14 XOR R12D,R12D
007a1a17 TEST EAX,EAX
007a1a19 JNS 0x007a1a44
007a1a1b MOV RAX,qword ptr [RBX + 0xa0]
007a1a22 MOV RAX,qword ptr [RAX + 0x58]
007a1a26 MOV qword ptr [RBP + 0x8],RAX
007a1a2a JMP 0x007a1a44
007a1a30 CMP RAX,-0x1
007a1a34 JZ 0x007a1a78
007a1a36 MOV qword ptr [RBP],RAX
007a1a3a MOV EAX,dword ptr [RBX + 0xc0]
007a1a40 TEST EAX,EAX
007a1a42 JG 0x007a1a06
007a1a44 AND DH,0x80
007a1a47 JNZ 0x007a1a6a
007a1a49 MOV RDI,qword ptr [RBX + 0x88]
007a1a50 MOV EAX,dword ptr [RDI + 0x4]
007a1a53 SUB EAX,0x1
007a1a56 MOV dword ptr [RDI + 0x4],EAX
007a1a59 JNZ 0x007a1a6a
007a1a5b MOV qword ptr [RDI + 0x8],0x0
007a1a63 XCHG dword ptr [RDI],EAX
007a1a65 CMP EAX,0x1
007a1a68 JG 0x007a1ac8
007a1a6a MOV EAX,R12D
007a1a6d POP RBX
007a1a6e POP RBP
007a1a6f POP R12
007a1a71 RET
007a1a78 MOV RAX,-0x58
007a1a7f MOV R12D,0xffffffff
007a1a85 MOV ECX,dword ptr FS:[RAX]
007a1a88 TEST ECX,ECX
007a1a8a JNZ 0x007a1a44
007a1a8c MOV dword ptr FS:[RAX],0x5
007a1a93 JMP 0x007a1a44
007a1a98 MOV RCX,qword ptr [RBX + 0x58]
007a1a9c SUB RCX,qword ptr [RBX + 0x48]
007a1aa0 SUB RAX,RCX
007a1aa3 CMP RAX,-0x1
007a1aa7 JZ 0x007a1a78
007a1aa9 MOV qword ptr [RBP],RAX
007a1aad XOR R12D,R12D
007a1ab0 JMP 0x007a1a44
007a1ab8 CALL 0x00709590
007a1abd JMP 0x007a19bc
007a1ac8 CALL 0x00709660
007a1acd JMP 0x007a1a6a
