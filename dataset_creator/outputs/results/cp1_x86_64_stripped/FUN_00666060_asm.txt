00666060 ENDBR64
00666064 PUSH R15
00666066 PUSH R14
00666068 PUSH R13
0066606a PUSH R12
0066606c MOV R12D,0x1
00666072 PUSH RBP
00666073 MOV RBP,RDI
00666076 PUSH RBX
00666077 SUB RSP,0xc8
0066607e MOV RAX,qword ptr FS:[0x28]
00666087 MOV qword ptr [RSP + 0xb8],RAX
0066608f MOV RAX,qword ptr [RDI + 0x28]
00666093 CMP qword ptr [RDI + 0x20],RAX
00666097 JNC 0x006660ab
00666099 MOV RAX,qword ptr [RDI]
0066609c MOV ESI,0xffffffff
006660a1 CALL qword ptr [RAX + 0x68]
006660a4 CMP EAX,-0x1
006660a7 SETNZ R12B
006660ab CMP byte ptr [RBP + 0xaa],0x0
006660b2 JZ 0x00666140
006660b8 MOV RDI,qword ptr [RBP + 0xc8]
006660bf TEST RDI,RDI
006660c2 JZ 0x006661ae
006660c8 MOV RAX,qword ptr [RDI]
006660cb CALL qword ptr [RAX + 0x30]
006660ce MOV EBX,EAX
006660d0 TEST AL,AL
006660d2 JNZ 0x00666140
006660d4 TEST R12B,R12B
006660d7 JZ 0x00666140
006660d9 LEA RAX,[RBP + 0x68]
006660dd LEA R14,[RBP + 0x84]
006660e4 MOV qword ptr [RSP + 0x8],RAX
006660e9 LEA R13,[RSP + 0x28]
006660ee LEA R15,[RSP + 0x30]
006660f3 LEA R12,[RSP + 0xb0]
006660fb MOV RDI,qword ptr [RBP + 0xc8]
00666102 MOV R8,R13
00666105 MOV RCX,R12
00666108 MOV RDX,R15
0066610b MOV RSI,R14
0066610e MOV RAX,qword ptr [RDI]
00666111 CALL qword ptr [RAX + 0x18]
00666114 CMP EAX,0x2
00666117 JZ 0x00666138
00666119 CMP EAX,0x1
0066611c JBE 0x00666170
0066611e MOV RAX,qword ptr [RBP]
00666122 MOV ESI,0xffffffff
00666127 MOV RDI,RBP
0066612a CALL qword ptr [RAX + 0x68]
0066612d CMP EAX,-0x1
00666130 SETNZ BL
00666133 NOP dword ptr [RAX + RAX*0x1]
00666138 MOV R12D,EBX
0066613b NOP dword ptr [RAX + RAX*0x1]
00666140 MOV RAX,qword ptr [RSP + 0xb8]
00666148 SUB RAX,qword ptr FS:[0x28]
00666151 JNZ 0x006661b3
00666153 ADD RSP,0xc8
0066615a MOV EAX,R12D
0066615d POP RBX
0066615e POP RBP
0066615f POP R12
00666161 POP R13
00666163 POP R14
00666165 POP R15
00666167 RET
00666170 MOV RDX,qword ptr [RSP + 0x28]
00666175 SUB RDX,R15
00666178 TEST RDX,RDX
0066617b JLE 0x0066611e
0066617d MOV RDI,qword ptr [RSP + 0x8]
00666182 MOV RSI,R15
00666185 MOV qword ptr [RSP + 0x10],RDX
0066618a MOV dword ptr [RSP + 0x1c],EAX
0066618e CALL 0x006c3f80
00666193 MOV RDX,qword ptr [RSP + 0x10]
00666198 MOV ECX,dword ptr [RSP + 0x1c]
0066619c CMP RDX,RAX
0066619f JNZ 0x00666138
006661a1 TEST ECX,ECX
006661a3 JNZ 0x006660fb
006661a9 JMP 0x0066611e
006661ae CALL 0x00403826
006661b3 CALL 0x00771f60
