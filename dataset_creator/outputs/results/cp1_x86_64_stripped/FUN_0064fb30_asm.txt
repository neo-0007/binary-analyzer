0064fb30 PUSH R12
0064fb32 PUSH RBP
0064fb33 MOV RBP,RSI
0064fb36 PUSH RBX
0064fb37 MOV RBX,RDI
0064fb3a SUB RSP,0x10
0064fb3e MOV RAX,qword ptr FS:[0x28]
0064fb47 MOV qword ptr [RSP + 0x8],RAX
0064fb4c XOR EAX,EAX
0064fb4e TEST RDX,RDX
0064fb51 JZ 0x0064fb5c
0064fb53 TEST RSI,RSI
0064fb56 JZ 0x0064fbed
0064fb5c SUB RDX,RBP
0064fb5f MOV R12,RDX
0064fb62 SAR R12,0x2
0064fb66 MOV qword ptr [RSP],R12
0064fb6a CMP RDX,0xc
0064fb6e JA 0x0064fbd0
0064fb70 MOV RDI,qword ptr [RBX]
0064fb73 CMP R12,0x1
0064fb77 JNZ 0x0064fbb0
0064fb79 MOV EAX,dword ptr [RBP]
0064fb7c MOV dword ptr [RDI],EAX
0064fb7e MOV RAX,qword ptr [RSP]
0064fb82 MOV qword ptr [RBX + 0x8],RAX
0064fb86 MOV dword ptr [RDI + RAX*0x4],0x0
0064fb8d MOV RAX,qword ptr [RSP + 0x8]
0064fb92 SUB RAX,qword ptr FS:[0x28]
0064fb9b JNZ 0x0064fbf9
0064fb9d ADD RSP,0x10
0064fba1 POP RBX
0064fba2 POP RBP
0064fba3 POP R12
0064fba5 RET
0064fbb0 TEST R12,R12
0064fbb3 JZ 0x0064fb7e
0064fbb5 MOV RCX,0x3fffffffffffffff
0064fbbf MOV RDX,R12
0064fbc2 MOV RSI,RBP
0064fbc5 CALL 0x00771ea0
0064fbca MOV RDI,qword ptr [RBX]
0064fbcd JMP 0x0064fb7e
0064fbd0 MOV RDI,RBX
0064fbd3 MOV RSI,RSP
0064fbd6 XOR EDX,EDX
0064fbd8 CALL 0x006b5350
0064fbdd MOV qword ptr [RBX],RAX
0064fbe0 MOV RDI,RAX
0064fbe3 MOV RAX,qword ptr [RSP]
0064fbe7 MOV qword ptr [RBX + 0x10],RAX
0064fbeb JMP 0x0064fb73
0064fbed LEA RDI,[0x81e738]
0064fbf4 CALL 0x00403890
0064fbf9 CALL 0x00771f60
