0070b100 ENDBR64
0070b104 PUSH RBP
0070b105 MOV R8,RDI
0070b108 PUSH RBX
0070b109 SUB RSP,0x8
0070b10d NOP
0070b10e MOV EDX,dword ptr [RDI + 0x18]
0070b111 MOV EAX,dword ptr FS:[0x2d0]
0070b119 CMP EDX,EAX
0070b11b JZ 0x0070b1e8
0070b121 MOV EAX,dword ptr [RDI + 0x1c]
0070b124 XOR ESI,ESI
0070b126 TEST EAX,EAX
0070b128 MOV EAX,dword ptr [RDI]
0070b12a SETNZ SIL
0070b12e SHL ESI,0x7
0070b131 MOV EBP,ESI
0070b133 LEA R9D,[RAX + -0x8]
0070b137 MOV ECX,R9D
0070b13a SHR ECX,0x3
0070b13d JZ 0x0070b188
0070b13f CMPXCHG.LOCK dword ptr [R8],R9D
0070b144 MOV EBX,EAX
0070b146 JNZ 0x0070b133
0070b148 TEST R9B,0x1
0070b14c JNZ 0x0070b1a0
0070b14e XOR R9D,EBX
0070b151 AND R9D,0x4
0070b155 JZ 0x0070b17b
0070b157 MOV ESI,EBP
0070b159 XOR R10D,R10D
0070b15c MOV EDX,0x7fffffff
0070b161 MOV RDI,R8
0070b164 XOR SIL,0x81
0070b168 MOV EAX,0xca
0070b16d SYSCALL
0070b16f CMP RAX,-0x1000
0070b175 JA 0x0070b25f
0070b17b ADD RSP,0x8
0070b17f XOR EAX,EAX
0070b181 POP RBX
0070b182 POP RBP
0070b183 RET
0070b188 MOV EDX,R9D
0070b18b OR EDX,0x1
0070b18e TEST R9B,0x2
0070b192 CMOVNZ R9D,EDX
0070b196 AND R9D,0xfffffffb
0070b19a JMP 0x0070b13f
0070b1a0 LEA RDI,[R8 + 0x8]
0070b1a4 MOV EAX,0x1
0070b1a9 XCHG dword ptr [RDI],EAX
0070b1ab TEST AL,0x2
0070b1ad JZ 0x0070b14e
0070b1af MOV ESI,EBP
0070b1b1 XOR R10D,R10D
0070b1b4 MOV EDX,0x7fffffff
0070b1b9 MOV EAX,0xca
0070b1be XOR SIL,0x81
0070b1c2 SYSCALL
0070b1c4 CMP RAX,-0x1000
0070b1ca JBE 0x0070b14e
0070b1cc ADD EAX,0x16
0070b1cf AND EAX,0xfffffff7
0070b1d2 JZ 0x0070b14e
0070b1d8 LEA RDI,[0x8294c8]
0070b1df CALL 0x00703110
0070b1e8 MOV EDX,dword ptr [RDI + 0x1c]
0070b1eb XOR R9D,R9D
0070b1ee LEA RBP,[RDI + 0xc]
0070b1f2 MOV dword ptr [RDI + 0x18],0x0
0070b1f9 TEST EDX,EDX
0070b1fb SETNZ R9B
0070b1ff XOR EAX,EAX
0070b201 SHL R9D,0x7
0070b205 XCHG dword ptr [RBP],EAX
0070b208 MOV ECX,dword ptr [RDI + 0x30]
0070b20b AND EAX,0x2
0070b20e MOV EBX,EAX
0070b210 TEST ECX,ECX
0070b212 JNZ 0x0070b270
0070b214 MOV EAX,dword ptr [R8]
0070b217 MOV ECX,EAX
0070b219 XOR EDX,EDX
0070b21b SHR ECX,0x3
0070b21e SETNZ DL
0070b221 XOR EDX,EAX
0070b223 XOR EDX,0x2
0070b226 CMPXCHG.LOCK dword ptr [R8],EDX
0070b22b JNZ 0x0070b217
0070b22d SHR EAX,0x3
0070b230 JNZ 0x0070b290
0070b232 TEST EBX,EBX
0070b234 JZ 0x0070b17b
0070b23a MOV ESI,R9D
0070b23d XOR R10D,R10D
0070b240 MOV EDX,0x1
0070b245 MOV RDI,RBP
0070b248 XOR SIL,0x81
0070b24c MOV EAX,0xca
0070b251 SYSCALL
0070b253 CMP RAX,-0x1000
0070b259 JBE 0x0070b17b
0070b25f ADD EAX,0x16
0070b262 AND EAX,0xfffffff7
0070b265 JNZ 0x0070b1d8
0070b26b JMP 0x0070b17b
0070b270 MOV EAX,dword ptr [RDI + 0x4]
0070b273 LEA RDX,[RDI + 0x4]
0070b277 TEST EAX,EAX
0070b279 JZ 0x0070b214
0070b27b MOV ECX,EAX
0070b27d OR ECX,0x80000000
0070b283 CMPXCHG.LOCK dword ptr [RDX],ECX
0070b287 JZ 0x0070b232
0070b289 JMP 0x0070b277
0070b290 LEA RDI,[R8 + 0x8]
0070b294 XOR EAX,EAX
0070b296 XCHG dword ptr [RDI],EAX
0070b298 TEST AL,0x2
0070b29a JZ 0x0070b232
0070b29c MOV ESI,R9D
0070b29f XOR R10D,R10D
0070b2a2 MOV EDX,0x7fffffff
0070b2a7 MOV EAX,0xca
0070b2ac XOR SIL,0x81
0070b2b0 SYSCALL
0070b2b2 CMP RAX,-0x1000
0070b2b8 JBE 0x0070b232
0070b2be ADD EAX,0x16
0070b2c1 AND EAX,0xfffffff7
0070b2c4 JNZ 0x0070b1d8
0070b2ca JMP 0x0070b232
