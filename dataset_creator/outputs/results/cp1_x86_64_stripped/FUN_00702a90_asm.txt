00702a90 ENDBR64
00702a94 PUSH R13
00702a96 PUSH R12
00702a98 MOV R12D,EDX
00702a9b PUSH RBP
00702a9c MOV RBP,RSI
00702a9f PUSH RBX
00702aa0 MOV RBX,RDI
00702aa3 SUB RSP,0x18
00702aa7 MOV EAX,dword ptr [RDI]
00702aa9 AND EAX,0x8000
00702aae JNZ 0x00702ae0
00702ab0 MOV R13,qword ptr FS:[0x10]
00702ab9 MOV RDI,qword ptr [RDI + 0x88]
00702ac0 CMP qword ptr [RDI + 0x8],R13
00702ac4 JZ 0x00702adc
00702ac6 MOV EDX,0x1
00702acb CMPXCHG.LOCK dword ptr [RDI],EDX
00702acf JNZ 0x00702b50
00702ad1 MOV RDI,qword ptr [RBX + 0x88]
00702ad8 MOV qword ptr [RDI + 0x8],R13
00702adc ADD dword ptr [RDI + 0x4],0x1
00702ae0 MOV ECX,0x3
00702ae5 MOV EDX,R12D
00702ae8 MOV RSI,RBP
00702aeb MOV RDI,RBX
00702aee CALL 0x006fe4a0
00702af3 CMP RAX,-0x1
00702af7 SETZ AL
00702afa MOVZX EAX,AL
00702afd NEG EAX
00702aff TEST dword ptr [RBX],0x8000
00702b05 JNZ 0x00702b2a
00702b07 MOV RDI,qword ptr [RBX + 0x88]
00702b0e MOV ECX,dword ptr [RDI + 0x4]
00702b11 LEA EDX,[RCX + -0x1]
00702b14 MOV dword ptr [RDI + 0x4],EDX
00702b17 TEST EDX,EDX
00702b19 JNZ 0x00702b2a
00702b1b MOV qword ptr [RDI + 0x8],0x0
00702b23 XCHG dword ptr [RDI],EDX
00702b25 CMP EDX,0x1
00702b28 JG 0x00702b38
00702b2a ADD RSP,0x18
00702b2e POP RBX
00702b2f POP RBP
00702b30 POP R12
00702b32 POP R13
00702b34 RET
00702b38 MOV dword ptr [RSP + 0xc],EAX
00702b3c CALL 0x00709660
00702b41 MOV EAX,dword ptr [RSP + 0xc]
00702b45 JMP 0x00702b2a
00702b50 CALL 0x00709590
00702b55 JMP 0x00702ad1
