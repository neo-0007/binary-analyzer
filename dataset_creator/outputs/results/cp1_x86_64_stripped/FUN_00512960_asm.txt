00512960 ENDBR64
00512964 PUSH RBP
00512965 MOV RBP,RSI
00512968 PUSH RBX
00512969 MOV RBX,RDX
0051296c SUB RSP,0x28
00512970 MOV RAX,qword ptr FS:[0x28]
00512979 MOV qword ptr [RSP + 0x18],RAX
0051297e XOR EAX,EAX
00512980 LEA RDX,[RSP + 0x10]
00512985 LEA RSI,[RSP + 0x8]
0051298a CALL 0x00512830
0051298f TEST EAX,EAX
00512991 JZ 0x005129d8
00512993 TEST RBP,RBP
00512996 JZ 0x005129ae
00512998 MOV RDX,qword ptr [RSP + 0x10]
0051299d MOV RSI,qword ptr [RSP + 0x8]
005129a2 MOV RDI,RBP
005129a5 CALL 0x004de450
005129aa TEST EAX,EAX
005129ac JZ 0x005129d8
005129ae MOV qword ptr [RBX],0x38
005129b5 MOV EAX,0x1
005129ba MOV RDX,qword ptr [RSP + 0x18]
005129bf SUB RDX,qword ptr FS:[0x28]
005129c8 JNZ 0x005129dc
005129ca ADD RSP,0x28
005129ce POP RBX
005129cf POP RBP
005129d0 RET
005129d8 XOR EAX,EAX
005129da JMP 0x005129ba
005129dc CALL 0x00771f60
