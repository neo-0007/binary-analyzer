004225c0 ENDBR64
004225c4 MOV R8,RBX
004225c7 XOR EAX,EAX
004225c9 MOV qword ptr [RDI + 0x8],RAX
004225cd CPUID
004225cf MOV R11D,EAX
004225d2 XOR EAX,EAX
004225d4 CMP EBX,0x756e6547
004225da SETNZ AL
004225dd MOV R9D,EAX
004225e0 CMP EDX,0x49656e69
004225e6 SETNZ AL
004225e9 OR R9D,EAX
004225ec CMP ECX,0x6c65746e
004225f2 SETNZ AL
004225f5 OR R9D,EAX
004225f8 JZ 0x00422685
004225fe CMP EBX,0x68747541
00422604 SETNZ AL
00422607 MOV R10D,EAX
0042260a CMP EDX,0x69746e65
00422610 SETNZ AL
00422613 OR R10D,EAX
00422616 CMP ECX,0x444d4163
0042261c SETNZ AL
0042261f OR R10D,EAX
00422622 JNZ 0x00422685
00422624 MOV EAX,0x80000000
00422629 CPUID
0042262b CMP EAX,0x80000001
00422630 JC 0x00422685
00422632 MOV R10D,EAX
00422635 MOV EAX,0x80000001
0042263a CPUID
0042263c OR R9D,ECX
0042263f AND R9D,0x801
00422646 CMP R10D,0x80000008
0042264d JC 0x00422685
0042264f MOV EAX,0x80000008
00422654 CPUID
00422656 MOVZX R10,CL
0042265a INC R10
0042265d MOV EAX,0x1
00422662 CPUID
00422664 BT EDX,0x1c
00422668 JNC 0x0042271a
0042266e SHR EBX,0x10
00422671 CMP BL,R10B
00422674 JA 0x0042271a
0042267a AND EDX,0xefffffff
00422680 JMP 0x0042271a
00422685 CMP R11D,0x4
00422689 MOV R10D,0xffffffff
0042268f JC 0x004226ab
00422691 MOV EAX,0x4
00422696 MOV ECX,0x0
0042269b CPUID
0042269d MOV R10D,EAX
004226a0 SHR R10D,0xe
004226a4 AND R10D,0xfff
004226ab MOV EAX,0x1
004226b0 CPUID
004226b2 MOVD XMM0,EAX
004226b6 AND EDX,0xbfefffff
004226bc CMP R9D,0x0
004226c0 JNZ 0x004226f4
004226c2 OR EDX,0x40000000
004226c8 AND AH,0xf
004226cb CMP AH,0xf
004226ce JNZ 0x004226d6
004226d0 OR EDX,0x100000
004226d6 CMP AH,0x6
004226d9 JNZ 0x004226f4
004226db AND EAX,0xfff0ff0
004226e0 CMP EAX,0x50670
004226e5 JZ 0x004226ee
004226e7 CMP EAX,0x80650
004226ec JNZ 0x004226f4
004226ee AND ECX,0xfbffffff
004226f4 BT EDX,0x1c
004226f8 JNC 0x0042271a
004226fa AND EDX,0xefffffff
00422700 CMP R10D,0x0
00422704 JZ 0x0042271a
00422706 OR EDX,0x10000000
0042270c SHR EBX,0x10
0042270f CMP BL,0x1
00422712 JA 0x0042271a
00422714 AND EDX,0xefffffff
0042271a AND R9D,0x800
00422721 AND ECX,0xfffff7ff
00422727 OR R9D,ECX
0042272a MOV R10D,EDX
0042272d CMP R11D,0x7
00422731 JC 0x00422765
00422733 MOV EAX,0x7
00422738 XOR ECX,ECX
0042273a CPUID
0042273c BT R9D,0x1a
00422741 JC 0x00422749
00422743 AND EBX,0xfff7ffff
00422749 MOVD EAX,XMM0
0042274d AND EAX,0xfff0ff0
00422752 CMP EAX,0x50650
00422757 JNZ 0x0042275f
00422759 AND EBX,0xfffeffff
0042275f MOV dword ptr [RDI + 0x8],EBX
00422762 MOV dword ptr [RDI + 0xc],ECX
00422765 BT R9D,0x1b
0042276a JNC 0x0042278c
0042276c XOR ECX,ECX
0042276e XGETBV
00422771 AND EAX,0xe6
00422776 CMP EAX,0xe6
0042277b JZ 0x0042279c
0042277d AND dword ptr [RDI + 0x8],0x3fdeffff
00422784 AND EAX,0x6
00422787 CMP EAX,0x6
0042278a JZ 0x0042279c
0042278c MOV EAX,0xefffe7ff
00422791 AND R9D,EAX
00422794 MOV EAX,0x3fdeffdf
00422799 AND dword ptr [RDI + 0x8],EAX
0042279c SHL R9,0x20
004227a0 MOV EAX,R10D
004227a3 MOV RBX,R8
004227a6 OR RAX,R9
004227a9 RET
