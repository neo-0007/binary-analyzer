005122b0 ENDBR64
005122b4 PUSH RBP
005122b5 MOV R8,RSI
005122b8 MOV RBP,RDI
005122bb XOR EDI,EDI
005122bd SUB RSP,0x20
005122c1 MOV RAX,qword ptr FS:[0x28]
005122ca MOV qword ptr [RSP + 0x18],RAX
005122cf XOR EAX,EAX
005122d1 LEA RCX,[RSP + 0x10]
005122d6 LEA RDX,[RSP + 0x4]
005122db LEA RSI,[RSP + 0x8]
005122e0 CALL 0x005afa30
005122e5 TEST EAX,EAX
005122e7 JNZ 0x00512308
005122e9 XOR EAX,EAX
005122eb MOV RDX,qword ptr [RSP + 0x18]
005122f0 SUB RDX,qword ptr FS:[0x28]
005122f9 JNZ 0x0051234c
005122fb ADD RSP,0x20
005122ff POP RBP
00512300 RET
00512308 SUB RSP,0x8
0051230c MOV RAX,qword ptr [RBP + 0x8]
00512310 XOR R9D,R9D
00512313 XOR R8D,R8D
00512316 PUSH 0x0
00512318 MOV EDX,dword ptr [RSP + 0x14]
0051231c MOV RSI,qword ptr [RSP + 0x18]
00512321 MOV RDI,qword ptr [RSP + 0x20]
00512326 MOV ECX,dword ptr [RAX]
00512328 CALL 0x00510f50
0051232d MOV RDX,RAX
00512330 POP RAX
00512331 POP RCX
00512332 TEST RDX,RDX
00512335 JZ 0x005122e9
00512337 MOV RAX,qword ptr [RBP + 0x8]
0051233b MOV RDI,RBP
0051233e MOV ESI,dword ptr [RAX]
00512340 CALL 0x0040f1c0
00512345 MOV EAX,0x1
0051234a JMP 0x005122eb
0051234c CALL 0x00771f60
