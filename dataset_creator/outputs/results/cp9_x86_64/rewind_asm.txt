007b6650 ENDBR64
007b6654 PUSH RBP
007b6655 PUSH RBX
007b6656 MOV RBX,RDI
007b6659 SUB RSP,0x8
007b665d MOV EAX,dword ptr [RDI]
007b665f AND EAX,0x8000
007b6664 JNZ 0x007b6696
007b6666 MOV RBP,qword ptr FS:[0x10]
007b666f MOV RDI,qword ptr [RDI + 0x88]
007b6676 CMP qword ptr [RDI + 0x8],RBP
007b667a JZ 0x007b6692
007b667c MOV EDX,0x1
007b6681 CMPXCHG.LOCK dword ptr [RDI],EDX
007b6685 JNZ 0x007b66f0
007b6687 MOV RDI,qword ptr [RBX + 0x88]
007b668e MOV qword ptr [RDI + 0x8],RBP
007b6692 ADD dword ptr [RDI + 0x4],0x1
007b6696 MOV ECX,0x3
007b669b XOR EDX,EDX
007b669d XOR ESI,ESI
007b669f MOV RDI,RBX
007b66a2 CALL 0x006f4a90
007b66a7 MOV EAX,dword ptr [RBX]
007b66a9 MOV EDX,EAX
007b66ab AND EDX,0xffffffcf
007b66ae MOV dword ptr [RBX],EDX
007b66b0 TEST AH,0x80
007b66b3 JNZ 0x007b66d6
007b66b5 MOV RDI,qword ptr [RBX + 0x88]
007b66bc MOV EAX,dword ptr [RDI + 0x4]
007b66bf SUB EAX,0x1
007b66c2 MOV dword ptr [RDI + 0x4],EAX
007b66c5 JNZ 0x007b66d6
007b66c7 MOV qword ptr [RDI + 0x8],0x0
007b66cf XCHG dword ptr [RDI],EAX
007b66d1 CMP EAX,0x1
007b66d4 JG 0x007b66e0
007b66d6 ADD RSP,0x8
007b66da POP RBX
007b66db POP RBP
007b66dc RET
007b66e0 ADD RSP,0x8
007b66e4 POP RBX
007b66e5 POP RBP
007b66e6 JMP 0x006ffc50
007b66f0 CALL 0x006ffb80
007b66f5 JMP 0x007b6687
