00799010 ENDBR64
00799014 MOV RCX,RSI
00799017 MOV ESI,EDX
00799019 MOVZX EAX,word ptr [RCX]
0079901c TEST AX,AX
0079901f JG 0x00799070
00799021 MOV EDX,dword ptr [0x009320d8]
00799027 TEST EDX,EDX
00799029 JG 0x00799039
0079902b JMP 0x00799060
00799030 TEST AL,0x2
00799032 JZ 0x00799080
00799034 SUB EDX,0x1
00799037 JZ 0x00799060
00799039 MOV EAX,0xffffffff
0079903e XBEGIN 0x00799044
00799044 CMP EAX,-0x1
00799047 JNZ 0x00799030
00799049 MOV EAX,dword ptr [RDI]
0079904b TEST EAX,EAX
0079904d JZ 0x0079906d
0079904f XABORT 0xff
00799052 SUB EDX,0x1
00799055 JNZ 0x00799039
00799057 NOP word ptr [RAX + RAX*0x1]
00799060 XOR EAX,EAX
00799062 MOV EDX,0x1
00799067 CMPXCHG.LOCK dword ptr [RDI],EDX
0079906b JNZ 0x007990a3
0079906d XOR EAX,EAX
0079906f RET
00799070 MOVZX EAX,word ptr [RCX]
00799073 SUB EAX,0x1
00799076 MOV word ptr [RCX],AX
00799079 JMP 0x00799060
00799080 TEST AL,0x1
00799082 JZ 0x0079908e
00799084 SHR EAX,0x18
00799087 CMP EAX,0xff
0079908c JZ 0x007990b3
0079908e MOVSX EAX,word ptr [RCX]
00799091 MOV EDX,dword ptr [0x009320d4]
00799097 CMP EAX,EDX
00799099 JZ 0x00799060
0079909b MOVZX EDX,DX
0079909e MOV word ptr [RCX],DX
007990a1 JMP 0x00799060
007990a3 SUB RSP,0x8
007990a7 CALL 0x006ffbe0
007990ac XOR EAX,EAX
007990ae ADD RSP,0x8
007990b2 RET
007990b3 MOVSX EAX,word ptr [RCX]
007990b6 MOV EDX,dword ptr [0x009320d0]
007990bc CMP EAX,EDX
007990be JZ 0x00799060
007990c0 JMP 0x0079909b
