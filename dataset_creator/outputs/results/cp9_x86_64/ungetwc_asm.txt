006f5170 ENDBR64
006f5174 PUSH R12
006f5176 PUSH RBP
006f5177 MOV EBP,EDI
006f5179 PUSH RBX
006f517a MOV RBX,RSI
006f517d SUB RSP,0x10
006f5181 MOV EAX,dword ptr [RSI]
006f5183 AND EAX,0x8000
006f5188 JNZ 0x006f51ba
006f518a MOV R12,qword ptr FS:[0x10]
006f5193 MOV RDI,qword ptr [RSI + 0x88]
006f519a CMP qword ptr [RDI + 0x8],R12
006f519e JZ 0x006f51b6
006f51a0 MOV EDX,0x1
006f51a5 CMPXCHG.LOCK dword ptr [RDI],EDX
006f51a9 JNZ 0x006f5220
006f51ab MOV RDI,qword ptr [RBX + 0x88]
006f51b2 MOV qword ptr [RDI + 0x8],R12
006f51b6 ADD dword ptr [RDI + 0x4],0x1
006f51ba MOV ESI,0x1
006f51bf MOV RDI,RBX
006f51c2 CALL 0x006f8220
006f51c7 MOV EAX,0xffffffff
006f51cc CMP EBP,-0x1
006f51cf JZ 0x006f51db
006f51d1 MOV ESI,EBP
006f51d3 MOV RDI,RBX
006f51d6 CALL 0x006f6450
006f51db TEST dword ptr [RBX],0x8000
006f51e1 JNZ 0x006f5206
006f51e3 MOV RDI,qword ptr [RBX + 0x88]
006f51ea MOV ECX,dword ptr [RDI + 0x4]
006f51ed LEA EDX,[RCX + -0x1]
006f51f0 MOV dword ptr [RDI + 0x4],EDX
006f51f3 TEST EDX,EDX
006f51f5 JNZ 0x006f5206
006f51f7 MOV qword ptr [RDI + 0x8],0x0
006f51ff XCHG dword ptr [RDI],EDX
006f5201 CMP EDX,0x1
006f5204 JG 0x006f5210
006f5206 ADD RSP,0x10
006f520a POP RBX
006f520b POP RBP
006f520c POP R12
006f520e RET
006f5210 MOV dword ptr [RSP + 0xc],EAX
006f5214 CALL 0x006ffc50
006f5219 MOV EAX,dword ptr [RSP + 0xc]
006f521d JMP 0x006f5206
006f5220 CALL 0x006ffb80
006f5225 JMP 0x006f51ab
