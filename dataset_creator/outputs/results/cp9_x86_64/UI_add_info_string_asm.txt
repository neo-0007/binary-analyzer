00582800 ENDBR64
00582804 PUSH RBP
00582805 XOR R8D,R8D
00582808 XOR ECX,ECX
0058280a MOV EDX,0x4
0058280f PUSH RBX
00582810 MOV RBX,RDI
00582813 MOV RDI,RSI
00582816 XOR ESI,ESI
00582818 SUB RSP,0x18
0058281c CALL 0x00581e40
00582821 TEST RAX,RAX
00582824 JZ 0x00582898
00582826 MOV RDI,qword ptr [RBX + 0x8]
0058282a MOV RBP,RAX
0058282d TEST RDI,RDI
00582830 JZ 0x00582878
00582832 MOV qword ptr [RBP + 0x28],0x0
0058283a MOV RSI,RBP
0058283d MOV qword ptr [RBP + 0x30],0x0
00582845 CALL 0x004347f0
0058284a TEST EAX,EAX
0058284c JLE 0x00582858
0058284e ADD RSP,0x18
00582852 POP RBX
00582853 POP RBP
00582854 RET
00582858 SUB EAX,0x1
0058285b MOV RDI,RBP
0058285e MOV dword ptr [RSP + 0xc],EAX
00582862 CALL 0x00581d20
00582867 MOV EAX,dword ptr [RSP + 0xc]
0058286b ADD RSP,0x18
0058286f POP RBX
00582870 POP RBP
00582871 RET
00582878 CALL 0x00434c80
0058287d MOV qword ptr [RBX + 0x8],RAX
00582881 MOV RDI,RAX
00582884 TEST RAX,RAX
00582887 JNZ 0x00582832
00582889 MOV RDI,RBP
0058288c CALL 0x00581d20
00582891 MOV EAX,0xffffffff
00582896 JMP 0x0058284e
00582898 MOV EAX,0xffffffff
0058289d JMP 0x0058284e
