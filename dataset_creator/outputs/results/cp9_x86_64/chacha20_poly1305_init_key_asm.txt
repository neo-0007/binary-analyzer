00521380 ENDBR64
00521384 PUSH RBX
00521385 MOV RAX,RDX
00521388 SUB RSP,0x20
0052138c MOV RDX,qword ptr FS:[0x28]
00521395 MOV qword ptr [RSP + 0x18],RDX
0052139a MOV RDX,RSI
0052139d OR RDX,RAX
005213a0 JZ 0x0052140d
005213a2 MOV R10,qword ptr [RDI + 0x78]
005213a6 MOV qword ptr [R10 + 0xa8],0x0
005213b1 MOV qword ptr [R10 + 0xb0],0x0
005213bc MOV qword ptr [R10 + 0xb8],0x0
005213c7 MOV qword ptr [R10 + 0xc8],-0x1
005213d2 TEST RAX,RAX
005213d5 JZ 0x00521468
005213db MOVSXD RDX,dword ptr [R10 + 0xc4]
005213e2 PXOR XMM0,XMM0
005213e6 MOV R8,RSP
005213e9 MOVAPS xmmword ptr [RSP],XMM0
005213ed CMP EDX,0x10
005213f0 JLE 0x00521430
005213f2 MOV RDX,R8
005213f5 CALL 0x005210e0
005213fa MOV EAX,dword ptr [R10 + 0x2c]
005213fe MOV RDX,qword ptr [R10 + 0x24]
00521402 MOV dword ptr [R10 + 0x80],EAX
00521409 MOV qword ptr [R10 + 0x78],RDX
0052140d MOV RAX,qword ptr [RSP + 0x18]
00521412 SUB RAX,qword ptr FS:[0x28]
0052141b JNZ 0x005214d8
00521421 ADD RSP,0x20
00521425 MOV EAX,0x1
0052142a POP RBX
0052142b RET
00521430 MOV R9,R8
00521433 SUB R9,RDX
00521436 ADD R9,0x10
0052143a CMP RDX,0x8
0052143e JNC 0x00521478
00521440 TEST DL,0x4
00521443 JNZ 0x005214c4
00521445 TEST RDX,RDX
00521448 JZ 0x005213f2
0052144a MOVZX R11D,byte ptr [RAX]
0052144e MOV byte ptr [R9],R11B
00521451 TEST DL,0x2
00521454 JZ 0x005213f2
00521456 MOVZX EAX,word ptr [RAX + RDX*0x1 + -0x2]
0052145b MOV word ptr [R9 + RDX*0x1 + -0x2],AX
00521461 JMP 0x005213f2
00521468 XOR EDX,EDX
0052146a CALL 0x005210e0
0052146f JMP 0x0052140d
00521478 MOV R11,qword ptr [RAX]
0052147b MOV qword ptr [R9],R11
0052147e MOV R11,qword ptr [RAX + RDX*0x1 + -0x8]
00521483 MOV qword ptr [R9 + RDX*0x1 + -0x8],R11
00521488 LEA R11,[R9 + 0x8]
0052148c AND R11,-0x8
00521490 SUB R9,R11
00521493 ADD RDX,R9
00521496 SUB RAX,R9
00521499 AND RDX,-0x8
0052149d CMP RDX,0x8
005214a1 JC 0x005213f2
005214a7 AND RDX,-0x8
005214ab XOR R9D,R9D
005214ae MOV RBX,qword ptr [RAX + R9*0x1]
005214b2 MOV qword ptr [R11 + R9*0x1],RBX
005214b6 ADD R9,0x8
005214ba CMP R9,RDX
005214bd JC 0x005214ae
005214bf JMP 0x005213f2
005214c4 MOV R11D,dword ptr [RAX]
005214c7 MOV dword ptr [R9],R11D
005214ca MOV EAX,dword ptr [RAX + RDX*0x1 + -0x4]
005214ce MOV dword ptr [R9 + RDX*0x1 + -0x4],EAX
005214d3 JMP 0x005213f2
005214d8 CALL 0x00768630
