00588050 ENDBR64
00588054 PUSH RBX
00588055 XOR EDX,EDX
00588057 MOV ESI,0xffffffff
0058805c MOV RBX,RDI
0058805f CALL 0x00587e70
00588064 MOV R8D,EAX
00588067 XOR EAX,EAX
00588069 CMP R8D,0x1
0058806d JNZ 0x0058807d
0058806f MOV EAX,0xffffffff
00588074 TEST byte ptr [RBX + 0xe8],0x4
0058807b JNZ 0x00588080
0058807d POP RBX
0058807e RET
00588080 MOV EAX,dword ptr [RBX + 0xf0]
00588086 POP RBX
00588087 RET
