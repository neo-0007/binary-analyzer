005397d0 ENDBR64
005397d4 CMP qword ptr [RDI + 0x28],0x0
005397d9 JZ 0x00539880
005397df PUSH R12
005397e1 PUSH RBP
005397e2 MOV RBP,RSI
005397e5 PUSH RBX
005397e6 TEST RSI,RSI
005397e9 JZ 0x00539878
005397ef MOV RAX,qword ptr [RDI + 0x20]
005397f3 MOV R12,RDX
005397f6 MOV RDX,qword ptr [RDI + 0x18]
005397fa MOV RBX,RDI
005397fd SUB RAX,RDX
00539800 CMP RSI,RAX
00539803 JA 0x00539878
00539805 MOV RDI,qword ptr [RDI]
00539808 TEST RDI,RDI
0053980b JZ 0x00539848
0053980d MOV RAX,qword ptr [RDI]
00539810 MOV RCX,RAX
00539813 SUB RCX,RDX
00539816 CMP RSI,RCX
00539819 JBE 0x00539848
0053981b CMP RSI,RAX
0053981e CMOVNC RAX,RSI
00539822 MOV RSI,-0x1
00539829 TEST RAX,RAX
0053982c JS 0x0053983e
0053982e LEA RSI,[RAX + RAX*0x1]
00539832 MOV EAX,0x100
00539837 CMP RSI,RAX
0053983a CMOVC RSI,RAX
0053983e CALL 0x004b8830
00539843 TEST RAX,RAX
00539846 JZ 0x00539878
00539848 TEST R12,R12
0053984b JZ 0x0053986b
0053984d MOV RDI,RBX
00539850 CALL 0x00539780
00539855 MOV qword ptr [R12],RAX
00539859 TEST byte ptr [RBX + 0x30],0x1
0053985d JZ 0x0053986b
0053985f TEST RAX,RAX
00539862 JZ 0x0053986b
00539864 SUB RAX,RBP
00539867 MOV qword ptr [R12],RAX
0053986b POP RBX
0053986c MOV EAX,0x1
00539871 POP RBP
00539872 POP R12
00539874 RET
00539878 POP RBX
00539879 XOR EAX,EAX
0053987b POP RBP
0053987c POP R12
0053987e RET
00539880 XOR EAX,EAX
00539882 RET
