00538530 ENDBR64
00538534 MOV RAX,RDI
00538537 MOV RDI,RSI
0053853a MOV RCX,qword ptr [RAX + 0x8]
0053853e TEST RCX,RCX
00538541 JZ 0x00538570
00538543 MOV RSI,qword ptr [RAX]
00538546 LEA R9,[RCX + -0x1]
0053854a MOVZX R10D,byte ptr [RSI]
0053854e LEA R8,[RSI + 0x1]
00538552 MOV qword ptr [RAX + 0x8],R9
00538556 MOV qword ptr [RAX],R8
00538559 TEST R10B,R10B
0053855c JNS 0x00538580
0053855e CMP R10D,0x81
00538565 JZ 0x005385a0
00538567 CMP R10D,0x82
0053856e JZ 0x005385c0
00538570 XOR R8D,R8D
00538573 MOV EAX,R8D
00538576 RET
00538580 CMP R10,R9
00538583 JA 0x00538570
00538585 MOV qword ptr [RDI],R8
00538588 ADD R8,R10
0053858b MOV qword ptr [RDI + 0x8],R10
0053858f MOV qword ptr [RAX],R8
00538592 MOV R8D,0x1
00538598 SUB qword ptr [RAX + 0x8],R10
0053859c MOV EAX,R8D
0053859f RET
005385a0 TEST R9,R9
005385a3 JZ 0x00538570
005385a5 MOVZX EDX,byte ptr [RSI + 0x1]
005385a9 SUB RCX,0x2
005385ad ADD RSI,0x2
005385b1 CMP RCX,RDX
005385b4 JNC 0x005385e1
005385b6 JMP 0x00538570
005385c0 XOR R8D,R8D
005385c3 CMP R9,0x1
005385c7 JBE 0x00538573
005385c9 MOVZX EDX,word ptr [RSI + 0x1]
005385cd SUB RCX,0x3
005385d1 ROL DX,0x8
005385d5 MOVZX EDX,DX
005385d8 CMP RDX,RCX
005385db JA 0x00538573
005385dd ADD RSI,0x3
005385e1 LEA R8,[RSI + RDX*0x1]
005385e5 SUB RCX,RDX
005385e8 MOV qword ptr [RAX],R8
005385eb MOV R8D,0x1
005385f1 MOV qword ptr [RAX + 0x8],RCX
005385f5 MOV qword ptr [RDI],RSI
005385f8 MOV qword ptr [RDI + 0x8],RDX
005385fc JMP 0x00538573
