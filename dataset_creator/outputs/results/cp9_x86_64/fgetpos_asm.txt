00798050 ENDBR64
00798054 PUSH R12
00798056 PUSH RBP
00798057 MOV RBP,RSI
0079805a PUSH RBX
0079805b MOV EAX,dword ptr [RDI]
0079805d MOV RBX,RDI
00798060 AND EAX,0x8000
00798065 JNZ 0x0079809b
00798067 MOV R12,qword ptr FS:[0x10]
00798070 MOV RDI,qword ptr [RDI + 0x88]
00798077 CMP qword ptr [RDI + 0x8],R12
0079807b JZ 0x00798097
0079807d MOV EDX,0x1
00798082 CMPXCHG.LOCK dword ptr [RDI],EDX
00798086 JNZ 0x00798188
0079808c MOV RDI,qword ptr [RBX + 0x88]
00798093 MOV qword ptr [RDI + 0x8],R12
00798097 ADD dword ptr [RDI + 0x4],0x1
0079809b XOR ECX,ECX
0079809d MOV EDX,0x1
007980a2 XOR ESI,ESI
007980a4 MOV RDI,RBX
007980a7 CALL 0x006f4a90
007980ac MOV EDX,dword ptr [RBX]
007980ae MOV R12D,EDX
007980b1 AND R12D,0x100
007980b8 JZ 0x00798100
007980ba CMP RAX,-0x1
007980be JZ 0x00798148
007980c4 MOV ESI,dword ptr [RBX + 0xc0]
007980ca TEST ESI,ESI
007980cc JLE 0x00798168
007980d2 MOV qword ptr [RBP],RAX
007980d6 MOV RDI,qword ptr [RBX + 0x98]
007980dd CALL 0x006f85a0
007980e2 MOV EDX,dword ptr [RBX]
007980e4 XOR R12D,R12D
007980e7 TEST EAX,EAX
007980e9 JNS 0x00798114
007980eb MOV RAX,qword ptr [RBX + 0xa0]
007980f2 MOV RAX,qword ptr [RAX + 0x58]
007980f6 MOV qword ptr [RBP + 0x8],RAX
007980fa JMP 0x00798114
00798100 CMP RAX,-0x1
00798104 JZ 0x00798148
00798106 MOV qword ptr [RBP],RAX
0079810a MOV EAX,dword ptr [RBX + 0xc0]
00798110 TEST EAX,EAX
00798112 JG 0x007980d6
00798114 AND DH,0x80
00798117 JNZ 0x0079813a
00798119 MOV RDI,qword ptr [RBX + 0x88]
00798120 MOV EAX,dword ptr [RDI + 0x4]
00798123 SUB EAX,0x1
00798126 MOV dword ptr [RDI + 0x4],EAX
00798129 JNZ 0x0079813a
0079812b MOV qword ptr [RDI + 0x8],0x0
00798133 XCHG dword ptr [RDI],EAX
00798135 CMP EAX,0x1
00798138 JG 0x00798198
0079813a MOV EAX,R12D
0079813d POP RBX
0079813e POP RBP
0079813f POP R12
00798141 RET
00798148 MOV RAX,-0x58
0079814f MOV R12D,0xffffffff
00798155 MOV ECX,dword ptr FS:[RAX]
00798158 TEST ECX,ECX
0079815a JNZ 0x00798114
0079815c MOV dword ptr FS:[RAX],0x5
00798163 JMP 0x00798114
00798168 MOV RCX,qword ptr [RBX + 0x58]
0079816c SUB RCX,qword ptr [RBX + 0x48]
00798170 SUB RAX,RCX
00798173 CMP RAX,-0x1
00798177 JZ 0x00798148
00798179 MOV qword ptr [RBP],RAX
0079817d XOR R12D,R12D
00798180 JMP 0x00798114
00798188 CALL 0x006ffb80
0079818d JMP 0x0079808c
00798198 CALL 0x006ffc50
0079819d JMP 0x0079813a
