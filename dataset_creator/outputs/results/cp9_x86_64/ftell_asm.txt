006f4340 ENDBR64
006f4344 PUSH RBP
006f4345 PUSH RBX
006f4346 MOV RBX,RDI
006f4349 SUB RSP,0x18
006f434d MOV EAX,dword ptr [RDI]
006f434f AND EAX,0x8000
006f4354 JNZ 0x006f438a
006f4356 MOV RBP,qword ptr FS:[0x10]
006f435f MOV RDI,qword ptr [RDI + 0x88]
006f4366 CMP qword ptr [RDI + 0x8],RBP
006f436a JZ 0x006f4386
006f436c MOV EDX,0x1
006f4371 CMPXCHG.LOCK dword ptr [RDI],EDX
006f4375 JNZ 0x006f4470
006f437b MOV RDI,qword ptr [RBX + 0x88]
006f4382 MOV qword ptr [RDI + 0x8],RBP
006f4386 ADD dword ptr [RDI + 0x4],0x1
006f438a XOR ECX,ECX
006f438c MOV EDX,0x1
006f4391 XOR ESI,ESI
006f4393 MOV RDI,RBX
006f4396 CALL 0x006f4a90
006f439b MOV EDX,dword ptr [RBX]
006f439d MOV ECX,EDX
006f439f AND ECX,0x8000
006f43a5 AND DH,0x1
006f43a8 JZ 0x006f43fb
006f43aa CMP RAX,-0x1
006f43ae JZ 0x006f4410
006f43b0 MOV ESI,dword ptr [RBX + 0xc0]
006f43b6 TEST ESI,ESI
006f43b8 JLE 0x006f43f0
006f43ba TEST ECX,ECX
006f43bc JNZ 0x006f43e2
006f43be MOV RDI,qword ptr [RBX + 0x88]
006f43c5 SUB dword ptr [RDI + 0x4],0x1
006f43c9 JNZ 0x006f43e2
006f43cb MOV qword ptr [RDI + 0x8],0x0
006f43d3 XOR EDX,EDX
006f43d5 XCHG dword ptr [RDI],EDX
006f43d7 CMP EDX,0x1
006f43da JG 0x006f4458
006f43dc CMP RAX,-0x1
006f43e0 JZ 0x006f4435
006f43e2 ADD RSP,0x18
006f43e6 POP RBX
006f43e7 POP RBP
006f43e8 RET
006f43f0 MOV RDX,qword ptr [RBX + 0x58]
006f43f4 SUB RDX,qword ptr [RBX + 0x48]
006f43f8 SUB RAX,RDX
006f43fb TEST ECX,ECX
006f43fd JNZ 0x006f43dc
006f43ff MOV RDI,qword ptr [RBX + 0x88]
006f4406 SUB dword ptr [RDI + 0x4],0x1
006f440a JNZ 0x006f43dc
006f440c JMP 0x006f43cb
006f4410 TEST ECX,ECX
006f4412 JNZ 0x006f4435
006f4414 MOV RDI,qword ptr [RBX + 0x88]
006f441b MOV EAX,dword ptr [RDI + 0x4]
006f441e SUB EAX,0x1
006f4421 MOV dword ptr [RDI + 0x4],EAX
006f4424 JNZ 0x006f4435
006f4426 MOV qword ptr [RDI + 0x8],0x0
006f442e XCHG dword ptr [RDI],EAX
006f4430 CMP EAX,0x1
006f4433 JG 0x006f447a
006f4435 MOV RDX,-0x58
006f443c MOV RAX,-0x1
006f4443 MOV ECX,dword ptr FS:[RDX]
006f4446 TEST ECX,ECX
006f4448 JNZ 0x006f43e2
006f444a MOV dword ptr FS:[RDX],0x5
006f4451 JMP 0x006f43e2
006f4458 MOV qword ptr [RSP + 0x8],RAX
006f445d CALL 0x006ffc50
006f4462 MOV RAX,qword ptr [RSP + 0x8]
006f4467 JMP 0x006f43dc
006f4470 CALL 0x006ffb80
006f4475 JMP 0x006f437b
006f447a CALL 0x006ffc50
006f447f JMP 0x006f4435
