00706050 PUSH RBP
00706051 PUSH RBX
00706052 SUB RSP,0x8
00706056 MOV RAX,-0x20
0070605d MOV RBP,qword ptr FS:[RAX]
00706061 TEST RBP,RBP
00706064 JZ 0x007060e0
00706066 XOR EAX,EAX
00706068 MOV EDX,0x1
0070606d CMPXCHG.LOCK dword ptr [RBP],EDX
00706072 JNZ 0x00706160
00706078 MOV ESI,0x280
0070607d MOV RDI,RBP
00706080 CALL 0x007050d0
00706085 MOV RBX,RAX
00706088 TEST RAX,RAX
0070608b JZ 0x00706120
00706091 XOR EAX,EAX
00706093 XCHG dword ptr [RBP],EAX
00706096 CMP EAX,0x1
00706099 JG 0x00706150
0070609f TEST RBX,RBX
007060a2 JZ 0x007060d8
007060a4 MOV qword ptr FS:[-0x30],RBX
007060ad LEA RDI,[RBX + 0x8]
007060b1 XOR EAX,EAX
007060b3 AND RDI,-0x8
007060b7 MOV qword ptr [RBX],0x0
007060be MOV qword ptr [RBX + 0x278],0x0
007060c9 SUB RBX,RDI
007060cc LEA ECX,[RBX + 0x280]
007060d2 SHR ECX,0x3
007060d5 STOSQ.REP RDI
007060d8 ADD RSP,0x8
007060dc POP RBX
007060dd POP RBP
007060de RET
007060e0 CALL 0x00702770
007060e5 MOV RBP,RAX
007060e8 TEST RAX,RAX
007060eb JNZ 0x00706078
007060ed XOR ESI,ESI
007060ef MOV EDI,0x280
007060f4 CALL 0x007040c0
007060f9 MOV ESI,0x280
007060fe MOV RDI,RAX
00706101 MOV RBP,RAX
00706104 CALL 0x007050d0
00706109 MOV RBX,RAX
0070610c TEST RAX,RAX
0070610f JNZ 0x00706140
00706111 TEST RBP,RBP
00706114 JZ 0x0070609f
00706116 NOP word ptr CS:[RAX + RAX*0x1]
00706120 MOV RDI,RBP
00706123 MOV ESI,0x280
00706128 CALL 0x007045b0
0070612d MOV ESI,0x280
00706132 MOV RDI,RAX
00706135 MOV RBP,RAX
00706138 CALL 0x007050d0
0070613d MOV RBX,RAX
00706140 TEST RBP,RBP
00706143 JZ 0x0070609f
00706149 JMP 0x00706091
00706150 MOV RDI,RBP
00706153 CALL 0x006ffc50
00706158 JMP 0x0070609f
00706160 MOV RDI,RBP
00706163 CALL 0x006ffb80
00706168 JMP 0x00706078
