006f9160 ENDBR64
006f9164 PUSH RBP
006f9165 PUSH RBX
006f9166 MOV RBX,RDI
006f9169 SUB RSP,0x18
006f916d MOV EAX,dword ptr [RDI]
006f916f AND EAX,0x8000
006f9174 JNZ 0x006f91aa
006f9176 MOV RBP,qword ptr FS:[0x10]
006f917f MOV RDI,qword ptr [RDI + 0x88]
006f9186 CMP qword ptr [RDI + 0x8],RBP
006f918a JZ 0x006f91a6
006f918c MOV EDX,0x1
006f9191 CMPXCHG.LOCK dword ptr [RDI],EDX
006f9195 JNZ 0x006f9290
006f919b MOV RDI,qword ptr [RBX + 0x88]
006f91a2 MOV qword ptr [RDI + 0x8],RBP
006f91a6 ADD dword ptr [RDI + 0x4],0x1
006f91aa XOR ECX,ECX
006f91ac MOV EDX,0x1
006f91b1 XOR ESI,ESI
006f91b3 MOV RDI,RBX
006f91b6 CALL 0x006f4a90
006f91bb MOV EDX,dword ptr [RBX]
006f91bd MOV ECX,EDX
006f91bf AND ECX,0x8000
006f91c5 AND DH,0x1
006f91c8 JZ 0x006f921b
006f91ca CMP RAX,-0x1
006f91ce JZ 0x006f9230
006f91d0 MOV ESI,dword ptr [RBX + 0xc0]
006f91d6 TEST ESI,ESI
006f91d8 JLE 0x006f9210
006f91da TEST ECX,ECX
006f91dc JNZ 0x006f9202
006f91de MOV RDI,qword ptr [RBX + 0x88]
006f91e5 SUB dword ptr [RDI + 0x4],0x1
006f91e9 JNZ 0x006f9202
006f91eb MOV qword ptr [RDI + 0x8],0x0
006f91f3 XOR EDX,EDX
006f91f5 XCHG dword ptr [RDI],EDX
006f91f7 CMP EDX,0x1
006f91fa JG 0x006f9278
006f91fc CMP RAX,-0x1
006f9200 JZ 0x006f9255
006f9202 ADD RSP,0x18
006f9206 POP RBX
006f9207 POP RBP
006f9208 RET
006f9210 MOV RDX,qword ptr [RBX + 0x58]
006f9214 SUB RDX,qword ptr [RBX + 0x48]
006f9218 SUB RAX,RDX
006f921b TEST ECX,ECX
006f921d JNZ 0x006f91fc
006f921f MOV RDI,qword ptr [RBX + 0x88]
006f9226 SUB dword ptr [RDI + 0x4],0x1
006f922a JNZ 0x006f91fc
006f922c JMP 0x006f91eb
006f9230 TEST ECX,ECX
006f9232 JNZ 0x006f9255
006f9234 MOV RDI,qword ptr [RBX + 0x88]
006f923b MOV EAX,dword ptr [RDI + 0x4]
006f923e SUB EAX,0x1
006f9241 MOV dword ptr [RDI + 0x4],EAX
006f9244 JNZ 0x006f9255
006f9246 MOV qword ptr [RDI + 0x8],0x0
006f924e XCHG dword ptr [RDI],EAX
006f9250 CMP EAX,0x1
006f9253 JG 0x006f929a
006f9255 MOV RDX,-0x58
006f925c MOV RAX,-0x1
006f9263 MOV ECX,dword ptr FS:[RDX]
006f9266 TEST ECX,ECX
006f9268 JNZ 0x006f9202
006f926a MOV dword ptr FS:[RDX],0x5
006f9271 JMP 0x006f9202
006f9278 MOV qword ptr [RSP + 0x8],RAX
006f927d CALL 0x006ffc50
006f9282 MOV RAX,qword ptr [RSP + 0x8]
006f9287 JMP 0x006f91fc
006f9290 CALL 0x006ffb80
006f9295 JMP 0x006f919b
006f929a CALL 0x006ffc50
006f929f JMP 0x006f9255
