00515ff0 PUSH R14
00515ff2 MOV R14,RSI
00515ff5 PUSH R13
00515ff7 MOV R13D,EDI
00515ffa PUSH R12
00515ffc MOV R12,RDX
00515fff PUSH RBP
00516000 PUSH RBX
00516001 MOV RBX,RCX
00516004 SUB RSP,0xb0
0051600b MOV RDI,qword ptr [RDX + 0x20]
0051600f MOV RAX,qword ptr FS:[0x28]
00516018 MOV qword ptr [RSP + 0xa8],RAX
00516020 XOR EAX,EAX
00516022 CALL 0x0052f270
00516027 MOV RBP,RAX
0051602a MOV RDI,RAX
0051602d TEST RBX,RBX
00516030 JNZ 0x00516070
00516032 CALL 0x00557a60
00516037 TEST RAX,RAX
0051603a JZ 0x00516047
0051603c MOV RDX,qword ptr [R12 + 0x30]
00516041 CMP dword ptr [RDX + 0x8],0x2
00516045 JZ 0x005160a0
00516047 MOV RAX,qword ptr [RSP + 0xa8]
0051604f SUB RAX,qword ptr FS:[0x28]
00516058 JNZ 0x005160d5
0051605a ADD RSP,0xb0
00516061 XOR EAX,EAX
00516063 POP RBX
00516064 POP RBP
00516065 POP R12
00516067 POP R13
00516069 POP R14
0051606b RET
00516070 CALL 0x005578d0
00516075 SUB RBX,0x1
00516079 CDQE
0051607b CMP RBX,RAX
0051607e JNC 0x00516047
00516080 LEA RDX,[RSP + 0x50]
00516085 MOV RSI,RSP
00516088 MOV RDI,RBP
0051608b CALL 0x00557980
00516090 TEST EAX,EAX
00516092 JZ 0x00516047
00516094 MOV RAX,qword ptr [RSP + RBX*0x8 + 0x50]
00516099 JMP 0x00516037
005160a0 MOV qword ptr [R12 + 0x20],RAX
005160a5 MOV RAX,qword ptr [RSP + 0xa8]
005160ad SUB RAX,qword ptr FS:[0x28]
005160b6 JNZ 0x005160d5
005160b8 ADD RSP,0xb0
005160bf MOV RDX,R12
005160c2 MOV RSI,R14
005160c5 MOV EDI,R13D
005160c8 POP RBX
005160c9 POP RBP
005160ca POP R12
005160cc POP R13
005160ce POP R14
005160d0 JMP 0x00513ea0
005160d5 CALL 0x00768630
