00421360 ENDBR64
00421364 MOV R10,RDI
00421367 MOV RCX,RSI
0042136a MOV R11,RDX
0042136d MOV qword ptr [RSP + 0x8],RCX
00421372 RDTSC
00421374 MOV R8D,EAX
00421377 MOV R9D,0x0
0042137d CLFLUSH byte ptr [R10]
00421381 ADD.LOCK dword ptr [R10],R9D
00421385 RDTSC
00421387 MOV EDX,EAX
00421389 SUB EAX,R8D
0042138c MOV R8D,EDX
0042138f MOV R9D,EAX
00421392 CLFLUSH byte ptr [R10]
00421396 ADD.LOCK dword ptr [R10],EAX
0042139a SUB R11,0x1
0042139e JZ 0x004213c1
004213a0 RDTSC
004213a2 MOV EDX,EAX
004213a4 SUB EAX,R8D
004213a7 MOV R8D,EDX
004213aa CMP EAX,R9D
004213ad MOV R9D,EAX
004213b0 MOV EDX,0x0
004213b5 SETNZ DL
004213b8 SUB RCX,RDX
004213bb LEA R10,[R10 + RDX*0x4]
004213bf JNZ 0x00421392
004213c1 MOV RAX,qword ptr [RSP + 0x8]
004213c6 SUB RAX,RCX
004213c9 RET
