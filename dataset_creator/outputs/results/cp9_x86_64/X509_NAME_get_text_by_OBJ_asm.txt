00597130 ENDBR64
00597134 PUSH R12
00597136 MOV R12,RDI
00597139 PUSH RBP
0059713a MOV EBP,ECX
0059713c PUSH RBX
0059713d MOV RBX,RDX
00597140 MOV EDX,0xffffffff
00597145 CALL 0x005968a0
0059714a TEST EAX,EAX
0059714c JS 0x005971b0
0059714e MOV RDI,R12
00597151 MOV ESI,EAX
00597153 CALL 0x00596970
00597158 MOV RDI,RAX
0059715b CALL 0x00597110
00597160 TEST RBX,RBX
00597163 JZ 0x005971a0
00597165 XOR R12D,R12D
00597168 TEST EBP,EBP
0059716a JLE 0x0059718f
0059716c MOV R12D,dword ptr [RAX]
0059716f LEA EDX,[RBP + -0x1]
00597172 MOV RSI,qword ptr [RAX + 0x8]
00597176 MOV RDI,RBX
00597179 CMP R12D,EBP
0059717c CMOVGE R12D,EDX
00597180 MOVSXD RBP,R12D
00597183 MOV RDX,RBP
00597186 CALL 0x00401030
0059718b MOV byte ptr [RBX + RBP*0x1],0x0
0059718f MOV EAX,R12D
00597192 POP RBX
00597193 POP RBP
00597194 POP R12
00597196 RET
005971a0 MOV R12D,dword ptr [RAX]
005971a3 POP RBX
005971a4 POP RBP
005971a5 MOV EAX,R12D
005971a8 POP R12
005971aa RET
005971b0 MOV R12D,0xffffffff
005971b6 JMP 0x0059718f
