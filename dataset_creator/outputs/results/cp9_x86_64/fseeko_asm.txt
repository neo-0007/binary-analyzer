006f9080 ENDBR64
006f9084 PUSH R13
006f9086 PUSH R12
006f9088 MOV R12D,EDX
006f908b PUSH RBP
006f908c MOV RBP,RSI
006f908f PUSH RBX
006f9090 MOV RBX,RDI
006f9093 SUB RSP,0x18
006f9097 MOV EAX,dword ptr [RDI]
006f9099 AND EAX,0x8000
006f909e JNZ 0x006f90d0
006f90a0 MOV R13,qword ptr FS:[0x10]
006f90a9 MOV RDI,qword ptr [RDI + 0x88]
006f90b0 CMP qword ptr [RDI + 0x8],R13
006f90b4 JZ 0x006f90cc
006f90b6 MOV EDX,0x1
006f90bb CMPXCHG.LOCK dword ptr [RDI],EDX
006f90bf JNZ 0x006f9140
006f90c1 MOV RDI,qword ptr [RBX + 0x88]
006f90c8 MOV qword ptr [RDI + 0x8],R13
006f90cc ADD dword ptr [RDI + 0x4],0x1
006f90d0 MOV ECX,0x3
006f90d5 MOV EDX,R12D
006f90d8 MOV RSI,RBP
006f90db MOV RDI,RBX
006f90de CALL 0x006f4a90
006f90e3 CMP RAX,-0x1
006f90e7 SETZ AL
006f90ea MOVZX EAX,AL
006f90ed NEG EAX
006f90ef TEST dword ptr [RBX],0x8000
006f90f5 JNZ 0x006f911a
006f90f7 MOV RDI,qword ptr [RBX + 0x88]
006f90fe MOV ECX,dword ptr [RDI + 0x4]
006f9101 LEA EDX,[RCX + -0x1]
006f9104 MOV dword ptr [RDI + 0x4],EDX
006f9107 TEST EDX,EDX
006f9109 JNZ 0x006f911a
006f910b MOV qword ptr [RDI + 0x8],0x0
006f9113 XCHG dword ptr [RDI],EDX
006f9115 CMP EDX,0x1
006f9118 JG 0x006f9128
006f911a ADD RSP,0x18
006f911e POP RBX
006f911f POP RBP
006f9120 POP R12
006f9122 POP R13
006f9124 RET
006f9128 MOV dword ptr [RSP + 0xc],EAX
006f912c CALL 0x006ffc50
006f9131 MOV EAX,dword ptr [RSP + 0xc]
006f9135 JMP 0x006f911a
006f9140 CALL 0x006ffb80
006f9145 JMP 0x006f90c1
