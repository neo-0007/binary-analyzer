007021f0 ENDBR64
007021f4 PUSH R12
007021f6 PUSH RBP
007021f7 PUSH RBX
007021f8 MOV RBX,qword ptr FS:[0x10]
00702201 MOV EAX,dword ptr [RBX + 0x30c]
00702207 AND EAX,0x60
0070220a CMP EAX,0x60
0070220d JZ 0x007022a0
00702213 LEA RBP,[RBX + 0x618]
0070221a XOR EAX,EAX
0070221c MOV EDX,0x1
00702221 CMPXCHG.LOCK dword ptr [RBP],EDX
00702226 JNZ 0x00702308
0070222c MOV EAX,dword ptr [RBX + 0x30c]
00702232 TEST AL,0x20
00702234 JZ 0x00702260
00702236 TEST AL,0x40
00702238 JZ 0x007022b0
0070223a MOV R12D,dword ptr [RBX + 0x638]
00702241 XOR EAX,EAX
00702243 XCHG dword ptr [RBX + 0x618],EAX
00702249 CMP EAX,0x1
0070224c JG 0x007022f8
00702252 MOV EAX,R12D
00702255 POP RBX
00702256 POP RBP
00702257 POP R12
00702259 RET
00702260 MOV EDI,dword ptr [RBX + 0x2d0]
00702266 LEA RSI,[RBX + 0x638]
0070226d CALL 0x0075f9a0
00702272 TEST EAX,EAX
00702274 JZ 0x007022d8
00702276 TEST byte ptr [RBX + 0x30c],0x40
0070227d JNZ 0x007022c6
0070227f MOV EDI,dword ptr [RBX + 0x2d0]
00702285 CALL 0x0075fa00
0070228a MOV dword ptr [RBX + 0x63c],EAX
00702290 CMP EAX,-0x1
00702293 JZ 0x007022c6
00702295 OR dword ptr [RBX + 0x30c],0x40
0070229c JMP 0x007022c6
007022a0 MOV R12D,dword ptr [RBX + 0x638]
007022a7 POP RBX
007022a8 POP RBP
007022a9 MOV EAX,R12D
007022ac POP R12
007022ae RET
007022b0 MOV EDI,dword ptr [RBX + 0x2d0]
007022b6 CALL 0x0075fa00
007022bb MOV dword ptr [RBX + 0x63c],EAX
007022c1 CMP EAX,-0x1
007022c4 JNZ 0x00702318
007022c6 MOV R12D,0xffffffff
007022cc JMP 0x00702241
007022d8 MOV EAX,dword ptr [RBX + 0x30c]
007022de OR EAX,0x20
007022e1 MOV dword ptr [RBX + 0x30c],EAX
007022e7 TEST AL,0x40
007022e9 JNZ 0x0070223a
007022ef JMP 0x007022b0
007022f8 MOV RDI,RBP
007022fb CALL 0x006ffc50
00702300 JMP 0x00702252
00702308 MOV RDI,RBP
0070230b CALL 0x006ffb80
00702310 JMP 0x0070222c
00702318 OR dword ptr [RBX + 0x30c],0x40
0070231f JMP 0x0070223a
