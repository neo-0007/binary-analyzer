00538c20 ENDBR64
00538c24 PUSH R13
00538c26 MOV R13,RDI
00538c29 MOV RDI,RSI
00538c2c PUSH R12
00538c2e MOV R12,RSI
00538c31 PUSH RBP
00538c32 PUSH RBX
00538c33 MOV RBX,RDX
00538c36 SUB RSP,0x18
00538c3a MOV RAX,qword ptr FS:[0x28]
00538c43 MOV qword ptr [RSP + 0x8],RAX
00538c48 XOR EAX,EAX
00538c4a MOV qword ptr [RSP],0x0
00538c52 CALL 0x004aff20
00538c57 MOV RDI,R12
00538c5a LEA EBP,[RAX + 0xe]
00538c5d ADD EAX,0x7
00538c60 CMOVNS EBP,EAX
00538c63 CALL 0x004af7b0
00538c68 MOV RDI,R13
00538c6b MOV RDX,RSP
00538c6e SAR EBP,0x3
00538c71 MOV R8,RAX
00538c74 MOVSXD RBP,EBP
00538c77 LEA RCX,[RBP + -0x1]
00538c7b MOV RSI,RBP
00538c7e MOV RAX,RCX
00538c81 AND ECX,0x7
00538c84 AND RAX,-0x8
00538c88 SHL ECX,0x3
00538c8b MOV RAX,qword ptr [R8 + RAX*0x1]
00538c8f SHR RAX,CL
00538c92 AND EAX,0xff
00538c97 MOV dword ptr [RBX],EAX
00538c99 CALL 0x00539890
00538c9e MOV R13D,EAX
00538ca1 TEST EAX,EAX
00538ca3 JZ 0x00538cbc
00538ca5 MOV RSI,qword ptr [RSP]
00538ca9 MOV R13D,0x1
00538caf TEST RSI,RSI
00538cb2 JZ 0x00538cbc
00538cb4 MOV RDI,R12
00538cb7 CALL 0x004b0b40
00538cbc MOV RAX,qword ptr [RSP + 0x8]
00538cc1 SUB RAX,qword ptr FS:[0x28]
00538cca JNZ 0x00538cda
00538ccc ADD RSP,0x18
00538cd0 MOV EAX,R13D
00538cd3 POP RBX
00538cd4 POP RBP
00538cd5 POP R12
00538cd7 POP R13
00538cd9 RET
00538cda CALL 0x00768630
