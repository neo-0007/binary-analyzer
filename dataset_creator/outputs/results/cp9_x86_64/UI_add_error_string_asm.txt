00582940 ENDBR64
00582944 PUSH RBP
00582945 XOR R8D,R8D
00582948 XOR ECX,ECX
0058294a MOV EDX,0x5
0058294f PUSH RBX
00582950 MOV RBX,RDI
00582953 MOV RDI,RSI
00582956 XOR ESI,ESI
00582958 SUB RSP,0x18
0058295c CALL 0x00581e40
00582961 TEST RAX,RAX
00582964 JZ 0x005829d8
00582966 MOV RDI,qword ptr [RBX + 0x8]
0058296a MOV RBP,RAX
0058296d TEST RDI,RDI
00582970 JZ 0x005829b8
00582972 MOV qword ptr [RBP + 0x28],0x0
0058297a MOV RSI,RBP
0058297d MOV qword ptr [RBP + 0x30],0x0
00582985 CALL 0x004347f0
0058298a TEST EAX,EAX
0058298c JLE 0x00582998
0058298e ADD RSP,0x18
00582992 POP RBX
00582993 POP RBP
00582994 RET
00582998 SUB EAX,0x1
0058299b MOV RDI,RBP
0058299e MOV dword ptr [RSP + 0xc],EAX
005829a2 CALL 0x00581d20
005829a7 MOV EAX,dword ptr [RSP + 0xc]
005829ab ADD RSP,0x18
005829af POP RBX
005829b0 POP RBP
005829b1 RET
005829b8 CALL 0x00434c80
005829bd MOV qword ptr [RBX + 0x8],RAX
005829c1 MOV RDI,RAX
005829c4 TEST RAX,RAX
005829c7 JNZ 0x00582972
005829c9 MOV RDI,RBP
005829cc CALL 0x00581d20
005829d1 MOV EAX,0xffffffff
005829d6 JMP 0x0058298e
005829d8 MOV EAX,0xffffffff
005829dd JMP 0x0058298e
