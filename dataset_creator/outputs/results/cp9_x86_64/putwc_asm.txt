006f5240 ENDBR64
006f5244 PUSH R12
006f5246 PUSH RBP
006f5247 MOV EBP,EDI
006f5249 PUSH RBX
006f524a MOV RBX,RSI
006f524d SUB RSP,0x10
006f5251 MOV EAX,dword ptr [RSI]
006f5253 AND EAX,0x8000
006f5258 JNZ 0x006f528e
006f525a MOV R12,qword ptr FS:[0x10]
006f5263 MOV RDI,qword ptr [RSI + 0x88]
006f526a CMP qword ptr [RDI + 0x8],R12
006f526e JZ 0x006f528a
006f5270 MOV EDX,0x1
006f5275 CMPXCHG.LOCK dword ptr [RDI],EDX
006f5279 JNZ 0x006f5310
006f527f MOV RDI,qword ptr [RBX + 0x88]
006f5286 MOV qword ptr [RDI + 0x8],R12
006f528a ADD dword ptr [RDI + 0x4],0x1
006f528e MOV RDX,qword ptr [RBX + 0xa0]
006f5295 MOV EAX,EBP
006f5297 TEST RDX,RDX
006f529a JZ 0x006f52e8
006f529c MOV RCX,qword ptr [RDX + 0x20]
006f52a0 CMP RCX,qword ptr [RDX + 0x28]
006f52a4 JNC 0x006f52e8
006f52a6 LEA RSI,[RCX + 0x4]
006f52aa MOV qword ptr [RDX + 0x20],RSI
006f52ae MOV dword ptr [RCX],EBP
006f52b0 TEST dword ptr [RBX],0x8000
006f52b6 JNZ 0x006f52db
006f52b8 MOV RDI,qword ptr [RBX + 0x88]
006f52bf MOV ECX,dword ptr [RDI + 0x4]
006f52c2 LEA EDX,[RCX + -0x1]
006f52c5 MOV dword ptr [RDI + 0x4],EDX
006f52c8 TEST EDX,EDX
006f52ca JNZ 0x006f52db
006f52cc MOV qword ptr [RDI + 0x8],0x0
006f52d4 XCHG dword ptr [RDI],EDX
006f52d6 CMP EDX,0x1
006f52d9 JG 0x006f52f8
006f52db ADD RSP,0x10
006f52df POP RBX
006f52e0 POP RBP
006f52e1 POP R12
006f52e3 RET
006f52e8 MOV ESI,EBP
006f52ea MOV RDI,RBX
006f52ed CALL 0x006f5970
006f52f2 JMP 0x006f52b0
006f52f8 MOV dword ptr [RSP + 0xc],EAX
006f52fc CALL 0x006ffc50
006f5301 MOV EAX,dword ptr [RSP + 0xc]
006f5305 JMP 0x006f52db
006f5310 CALL 0x006ffb80
006f5315 JMP 0x006f527f
