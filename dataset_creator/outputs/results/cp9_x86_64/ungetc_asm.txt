006f4fa0 ENDBR64
006f4fa4 CMP EDI,-0x1
006f4fa7 JZ 0x006f507a
006f4fad PUSH R12
006f4faf PUSH RBP
006f4fb0 MOV RBP,RSI
006f4fb3 PUSH RBX
006f4fb4 MOV EBX,EDI
006f4fb6 SUB RSP,0x10
006f4fba TEST byte ptr [RSI + 0x74],0x80
006f4fbe JZ 0x006f5048
006f4fc4 MOV EAX,dword ptr [RSI]
006f4fc6 AND EAX,0x8000
006f4fcb JNZ 0x006f5001
006f4fcd MOV R12,qword ptr FS:[0x10]
006f4fd6 MOV RDI,qword ptr [RSI + 0x88]
006f4fdd CMP qword ptr [RDI + 0x8],R12
006f4fe1 JZ 0x006f4ffd
006f4fe3 MOV EDX,0x1
006f4fe8 CMPXCHG.LOCK dword ptr [RDI],EDX
006f4fec JNZ 0x006f5070
006f4ff2 MOV RDI,qword ptr [RBP + 0x88]
006f4ff9 MOV qword ptr [RDI + 0x8],R12
006f4ffd ADD dword ptr [RDI + 0x4],0x1
006f5001 MOVZX ESI,BL
006f5004 MOV RDI,RBP
006f5007 CALL 0x006fdbe0
006f500c TEST dword ptr [RBP],0x8000
006f5013 JNZ 0x006f5038
006f5015 MOV RDI,qword ptr [RBP + 0x88]
006f501c MOV ECX,dword ptr [RDI + 0x4]
006f501f LEA EDX,[RCX + -0x1]
006f5022 MOV dword ptr [RDI + 0x4],EDX
006f5025 TEST EDX,EDX
006f5027 JNZ 0x006f5038
006f5029 MOV qword ptr [RDI + 0x8],0x0
006f5031 XCHG dword ptr [RDI],EDX
006f5033 CMP EDX,0x1
006f5036 JG 0x006f5060
006f5038 ADD RSP,0x10
006f503c POP RBX
006f503d POP RBP
006f503e POP R12
006f5040 RET
006f5048 ADD RSP,0x10
006f504c MOVZX ESI,DIL
006f5050 MOV RDI,RBP
006f5053 POP RBX
006f5054 POP RBP
006f5055 POP R12
006f5057 JMP 0x006fdbe0
006f5060 MOV dword ptr [RSP + 0xc],EAX
006f5064 CALL 0x006ffc50
006f5069 MOV EAX,dword ptr [RSP + 0xc]
006f506d JMP 0x006f5038
006f5070 CALL 0x006ffb80
006f5075 JMP 0x006f4ff2
006f507a MOV EAX,0xffffffff
006f507f RET
