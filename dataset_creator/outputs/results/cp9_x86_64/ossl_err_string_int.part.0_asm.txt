0050ff80 PUSH R15
0050ff82 PUSH R14
0050ff84 PUSH R13
0050ff86 MOV R13,RCX
0050ff89 PUSH R12
0050ff8b MOV R12,RDI
0050ff8e PUSH RBP
0050ff8f MOV RBP,RDX
0050ff92 PUSH RBX
0050ff93 MOV RBX,RSI
0050ff96 SUB RSP,0x168
0050ff9d MOV RAX,qword ptr FS:[0x28]
0050ffa6 MOV qword ptr [RSP + 0x158],RAX
0050ffae XOR EAX,EAX
0050ffb0 TEST EDI,0x80000000
0050ffb6 JNZ 0x00510090
0050ffbc MOV R14,RDI
0050ffbf SHR R14,0x17
0050ffc3 MOVZX EAX,R14B
0050ffc7 MOV qword ptr [RSP],RAX
0050ffcb CALL 0x0050fdc0
0050ffd0 MOV R14,RAX
0050ffd3 TEST RAX,RAX
0050ffd6 JZ 0x00510138
0050ffdc MOV R15,R12
0050ffdf MOV RDI,R12
0050ffe2 AND R15D,0x7fffff
0050ffe9 CALL 0x0050fe80
0050ffee TEST RAX,RAX
0050fff1 JZ 0x00510060
0050fff3 SUB RSP,0x8
0050fff7 MOV R8,R14
0050fffa MOV RCX,R12
0050fffd MOV RSI,R13
00510000 PUSH RAX
00510001 MOV R9,RBX
00510004 LEA RDX,[0x7f7fc2]
0051000b MOV RDI,RBP
0051000e XOR EAX,EAX
00510010 CALL 0x004abab0
00510015 MOV RDI,RBP
00510018 CALL 0x004010a0
0051001d POP RCX
0051001e POP RSI
0051001f MOV R8,RAX
00510022 LEA RAX,[R13 + -0x1]
00510026 CMP R8,RAX
00510029 JZ 0x005100e0
0051002f MOV RAX,qword ptr [RSP + 0x158]
00510037 SUB RAX,qword ptr FS:[0x28]
00510040 JNZ 0x0051015c
00510046 ADD RSP,0x168
0051004d POP RBX
0051004e POP RBP
0051004f POP R12
00510051 POP R13
00510053 POP R14
00510055 POP R15
00510057 RET
00510060 LEA R9,[RSP + 0x50]
00510065 MOV RCX,R15
00510068 LEA RDX,[0x7dee7c]
0051006f MOV RDI,R9
00510072 XOR EAX,EAX
00510074 MOV ESI,0x100
00510079 MOV qword ptr [RSP + 0x8],R9
0051007e CALL 0x004abab0
00510083 MOV RAX,qword ptr [RSP + 0x8]
00510088 JMP 0x0050fff3
00510090 CALL 0x0050fdc0
00510095 MOV R14,RAX
00510098 TEST RAX,RAX
0051009b JZ 0x00510110
0051009d LEA R9,[RSP + 0x50]
005100a2 MOV EDI,R12D
005100a5 MOV EDX,0x100
005100aa MOV R15,R12
005100ad AND EDI,0x7fffffff
005100b3 MOV RSI,R9
005100b6 MOV qword ptr [RSP],R9
005100ba AND R15D,0x7fffffff
005100c1 CALL 0x0041b3b0
005100c6 MOV R9,qword ptr [RSP]
005100ca MOV qword ptr [RSP],0x2
005100d2 TEST EAX,EAX
005100d4 JZ 0x00510065
005100d6 MOV RAX,R9
005100d9 JMP 0x0050fff3
005100e0 SUB RSP,0x8
005100e4 LEA RDX,[0x7f7fd7]
005100eb XOR R9D,R9D
005100ee XOR EAX,EAX
005100f0 PUSH R15
005100f2 MOV R8,qword ptr [RSP + 0x10]
005100f7 MOV RCX,R12
005100fa MOV RSI,R13
005100fd MOV RDI,RBP
00510100 CALL 0x004abab0
00510105 POP RAX
00510106 POP RDX
00510107 JMP 0x0051002f
00510110 LEA R14,[RSP + 0x10]
00510115 MOV ECX,0x2
0051011a LEA RDX,[0x7f7feb]
00510121 XOR EAX,EAX
00510123 MOV ESI,0x40
00510128 MOV RDI,R14
0051012b CALL 0x004abab0
00510130 JMP 0x0051009d
00510138 LEA R14,[RSP + 0x10]
0051013d MOV RCX,qword ptr [RSP]
00510141 MOV ESI,0x40
00510146 XOR EAX,EAX
00510148 LEA RDX,[0x7f7feb]
0051014f MOV RDI,R14
00510152 CALL 0x004abab0
00510157 JMP 0x0050ffdc
0051015c CALL 0x00768630
