00701500 ENDBR64
00701504 PUSH R12
00701506 PUSH RBP
00701507 PUSH RBX
00701508 MOV RBX,RDI
0070150b NOP
0070150c MOV EDX,dword ptr [RDI + 0x18]
0070150f MOV EAX,dword ptr FS:[0x2d0]
00701517 CMP EDX,EAX
00701519 JZ 0x007015b0
0070151f CMP dword ptr [RDI + 0x30],0x2
00701523 JZ 0x00701550
00701525 MOV EAX,0x8
0070152a XADD.LOCK dword ptr [RBX],EAX
0070152e ADD EAX,0x8
00701531 TEST EAX,EAX
00701533 JS 0x007015c0
00701539 TEST AL,0x1
0070153b JNZ 0x007015e0
00701541 XOR R8D,R8D
00701544 NOP
00701545 POP RBX
00701546 MOV EAX,R8D
00701549 POP RBP
0070154a POP R12
0070154c RET
00701550 MOV ESI,dword ptr [RDI]
00701552 MOV EAX,ESI
00701554 AND EAX,0x3
00701557 CMP EAX,0x2
0070155a JNZ 0x00701525
0070155c MOV EAX,ESI
0070155e SHR EAX,0x3
00701561 JZ 0x00701525
00701563 MOV EDX,ESI
00701565 MOV EAX,ESI
00701567 OR EDX,0x4
0070156a CMPXCHG.LOCK dword ptr [RBX],EDX
0070156e MOV ESI,EAX
00701570 JZ 0x0070157d
00701572 JMP 0x00701552
00701578 CMP EAX,0x4b
0070157b JZ 0x00701544
0070157d MOV ESI,dword ptr [RBX]
0070157f TEST SIL,0x4
00701583 JZ 0x00701552
00701585 MOV EDI,dword ptr [RBX + 0x1c]
00701588 XOR R8D,R8D
0070158b TEST EDI,EDI
0070158d MOV RDI,RBX
00701590 SETNZ R8B
00701594 XOR ECX,ECX
00701596 XOR EDX,EDX
00701598 SHL R8D,0x7
0070159c CALL 0x00799100
007015a1 MOV R8D,EAX
007015a4 CMP EAX,0x6e
007015a7 JNZ 0x00701578
007015a9 JMP 0x00701544
007015b0 MOV R8D,0x23
007015b6 JMP 0x00701544
007015c0 LEA EDX,[RAX + -0x8]
007015c3 CMPXCHG.LOCK dword ptr [RBX],EDX
007015c7 JNZ 0x00701531
007015cd MOV R8D,0xb
007015d3 JMP 0x00701544
007015e0 MOV EDX,EAX
007015e2 AND EDX,0x3
007015e5 CMP EDX,0x1
007015e8 JNZ 0x00701650
007015ea MOV EDX,EAX
007015ec XOR EDX,0x1
007015ef CMPXCHG.LOCK dword ptr [RBX],EDX
007015f3 JNZ 0x007015e0
007015f5 LEA RDI,[RBX + 0x8]
007015f9 XOR EAX,EAX
007015fb XCHG dword ptr [RDI],EAX
007015fd TEST AL,0x2
007015ff JZ 0x00701541
00701605 MOV ECX,dword ptr [RBX + 0x1c]
00701608 XOR ESI,ESI
0070160a MOV EDX,0x7fffffff
0070160f MOV EAX,0xca
00701614 TEST ECX,ECX
00701616 SETNZ SIL
0070161a XOR R10D,R10D
0070161d SHL ESI,0x7
00701620 XOR SIL,0x81
00701624 SYSCALL
00701626 CMP RAX,-0x1000
0070162c JBE 0x00701541
00701632 ADD EAX,0x16
00701635 AND EAX,0xfffffff7
00701638 JZ 0x00701541
0070163e LEA RDI,[0x81f2a8]
00701645 CALL 0x006f9700
00701650 LEA RBP,[RBX + 0x8]
00701654 XOR R12D,R12D
00701657 MOV EAX,dword ptr [RBP]
0070165a MOV EDX,EAX
0070165c OR EDX,0x2
0070165f CMP EDX,0x3
00701662 JZ 0x0070168a
00701664 TEST R12B,R12B
00701667 JNZ 0x00701541
0070166d MOV EAX,dword ptr [RBX]
0070166f TEST AL,0x1
00701671 JNZ 0x00701657
00701673 MOV EAX,dword ptr [RBP]
00701676 MOV EDX,EAX
00701678 OR EDX,0x2
0070167b CMP EDX,0x3
0070167e JNZ 0x00701541
00701684 MOV R12D,0x1
0070168a MOV EDX,dword ptr [RBX + 0x1c]
0070168d XOR R8D,R8D
00701690 TEST EDX,EDX
00701692 SETNZ R8B
00701696 SHL R8D,0x7
0070169a TEST AL,0x2
0070169c JNZ 0x007016aa
0070169e MOV EDX,0x3
007016a3 CMPXCHG.LOCK dword ptr [RBP],EDX
007016a8 JNZ 0x00701657
007016aa XOR ECX,ECX
007016ac XOR EDX,EDX
007016ae MOV ESI,0x3
007016b3 MOV RDI,RBP
007016b6 CALL 0x00799100
007016bb MOV R8D,EAX
007016be CMP EAX,0x6e
007016c1 JZ 0x007016c8
007016c3 CMP EAX,0x4b
007016c6 JNZ 0x00701657
007016c8 MOV EAX,dword ptr [RBX]
007016ca TEST AL,0x1
007016cc JZ 0x007016dd
007016ce LEA EDX,[RAX + -0x8]
007016d1 CMPXCHG.LOCK dword ptr [RBX],EDX
007016d5 JZ 0x00701544
007016db JMP 0x007016ca
007016dd MOV EAX,dword ptr [RBP]
007016e0 OR EAX,0x2
007016e3 CMP EAX,0x3
007016e6 JZ 0x007016dd
007016e8 JMP 0x00701541
