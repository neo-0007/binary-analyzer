005166e0 PUSH R14
005166e2 PUSH R13
005166e4 MOV R13,RSI
005166e7 PUSH R12
005166e9 MOV R12,RDX
005166ec PUSH RBP
005166ed MOV EBP,EDI
005166ef PUSH RBX
005166f0 MOV RBX,RCX
005166f3 SUB RSP,0xb0
005166fa MOV RDI,qword ptr [RDX + 0x20]
005166fe MOV RAX,qword ptr FS:[0x28]
00516707 MOV qword ptr [RSP + 0xa8],RAX
0051670f XOR EAX,EAX
00516711 CALL 0x0052f270
00516716 MOV R14,RAX
00516719 TEST RBX,RBX
0051671c JZ 0x00516770
0051671e CMP RBX,0x1
00516722 JZ 0x005167c0
00516728 MOV RDI,RAX
0051672b SUB RBX,0x2
0051672f CALL 0x005578d0
00516734 CDQE
00516736 CMP RBX,RAX
00516739 JC 0x005167d0
0051673f MOV RAX,qword ptr [RSP + 0xa8]
00516747 SUB RAX,qword ptr FS:[0x28]
00516750 JNZ 0x005167ee
00516756 ADD RSP,0xb0
0051675d XOR EAX,EAX
0051675f POP RBX
00516760 POP RBP
00516761 POP R12
00516763 POP R13
00516765 POP R14
00516767 RET
00516770 MOV RDI,RAX
00516773 CALL 0x00557a40
00516778 TEST RAX,RAX
0051677b JZ 0x0051673f
0051677d MOV RDX,qword ptr [R12 + 0x30]
00516782 CMP dword ptr [RDX + 0x8],0x2
00516786 JNZ 0x0051673f
00516788 MOV qword ptr [R12 + 0x20],RAX
0051678d MOV RAX,qword ptr [RSP + 0xa8]
00516795 SUB RAX,qword ptr FS:[0x28]
0051679e JNZ 0x005167ee
005167a0 ADD RSP,0xb0
005167a7 MOV RDX,R12
005167aa MOV RSI,R13
005167ad MOV EDI,EBP
005167af POP RBX
005167b0 POP RBP
005167b1 POP R12
005167b3 POP R13
005167b5 POP R14
005167b7 JMP 0x00513ea0
005167c0 MOV RDI,RAX
005167c3 CALL 0x00557a50
005167c8 JMP 0x00516778
005167d0 LEA RDX,[RSP + 0x50]
005167d5 MOV RSI,RSP
005167d8 MOV RDI,R14
005167db CALL 0x00557980
005167e0 TEST EAX,EAX
005167e2 JZ 0x0051673f
005167e8 MOV RAX,qword ptr [RSP + RBX*0x8]
005167ec JMP 0x00516778
005167ee CALL 0x00768630
