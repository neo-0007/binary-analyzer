007016f0 ENDBR64
007016f4 PUSH RBP
007016f5 MOV R8,RDI
007016f8 PUSH RBX
007016f9 SUB RSP,0x8
007016fd NOP
007016fe MOV EDX,dword ptr [RDI + 0x18]
00701701 MOV EAX,dword ptr FS:[0x2d0]
00701709 CMP EDX,EAX
0070170b JZ 0x007017d8
00701711 MOV EAX,dword ptr [RDI + 0x1c]
00701714 XOR ESI,ESI
00701716 TEST EAX,EAX
00701718 MOV EAX,dword ptr [RDI]
0070171a SETNZ SIL
0070171e SHL ESI,0x7
00701721 MOV EBP,ESI
00701723 LEA R9D,[RAX + -0x8]
00701727 MOV ECX,R9D
0070172a SHR ECX,0x3
0070172d JZ 0x00701778
0070172f CMPXCHG.LOCK dword ptr [R8],R9D
00701734 MOV EBX,EAX
00701736 JNZ 0x00701723
00701738 TEST R9B,0x1
0070173c JNZ 0x00701790
0070173e XOR R9D,EBX
00701741 AND R9D,0x4
00701745 JZ 0x0070176b
00701747 MOV ESI,EBP
00701749 XOR R10D,R10D
0070174c MOV EDX,0x7fffffff
00701751 MOV RDI,R8
00701754 XOR SIL,0x81
00701758 MOV EAX,0xca
0070175d SYSCALL
0070175f CMP RAX,-0x1000
00701765 JA 0x0070184f
0070176b ADD RSP,0x8
0070176f XOR EAX,EAX
00701771 POP RBX
00701772 POP RBP
00701773 RET
00701778 MOV EDX,R9D
0070177b OR EDX,0x1
0070177e TEST R9B,0x2
00701782 CMOVNZ R9D,EDX
00701786 AND R9D,0xfffffffb
0070178a JMP 0x0070172f
00701790 LEA RDI,[R8 + 0x8]
00701794 MOV EAX,0x1
00701799 XCHG dword ptr [RDI],EAX
0070179b TEST AL,0x2
0070179d JZ 0x0070173e
0070179f MOV ESI,EBP
007017a1 XOR R10D,R10D
007017a4 MOV EDX,0x7fffffff
007017a9 MOV EAX,0xca
007017ae XOR SIL,0x81
007017b2 SYSCALL
007017b4 CMP RAX,-0x1000
007017ba JBE 0x0070173e
007017bc ADD EAX,0x16
007017bf AND EAX,0xfffffff7
007017c2 JZ 0x0070173e
007017c8 LEA RDI,[0x81f2a8]
007017cf CALL 0x006f9700
007017d8 MOV EDX,dword ptr [RDI + 0x1c]
007017db XOR R9D,R9D
007017de LEA RBP,[RDI + 0xc]
007017e2 MOV dword ptr [RDI + 0x18],0x0
007017e9 TEST EDX,EDX
007017eb SETNZ R9B
007017ef XOR EAX,EAX
007017f1 SHL R9D,0x7
007017f5 XCHG dword ptr [RBP],EAX
007017f8 MOV ECX,dword ptr [RDI + 0x30]
007017fb AND EAX,0x2
007017fe MOV EBX,EAX
00701800 TEST ECX,ECX
00701802 JNZ 0x00701860
00701804 MOV EAX,dword ptr [R8]
00701807 MOV ECX,EAX
00701809 XOR EDX,EDX
0070180b SHR ECX,0x3
0070180e SETNZ DL
00701811 XOR EDX,EAX
00701813 XOR EDX,0x2
00701816 CMPXCHG.LOCK dword ptr [R8],EDX
0070181b JNZ 0x00701807
0070181d SHR EAX,0x3
00701820 JNZ 0x00701880
00701822 TEST EBX,EBX
00701824 JZ 0x0070176b
0070182a MOV ESI,R9D
0070182d XOR R10D,R10D
00701830 MOV EDX,0x1
00701835 MOV RDI,RBP
00701838 XOR SIL,0x81
0070183c MOV EAX,0xca
00701841 SYSCALL
00701843 CMP RAX,-0x1000
00701849 JBE 0x0070176b
0070184f ADD EAX,0x16
00701852 AND EAX,0xfffffff7
00701855 JNZ 0x007017c8
0070185b JMP 0x0070176b
00701860 MOV EAX,dword ptr [RDI + 0x4]
00701863 LEA RDX,[RDI + 0x4]
00701867 TEST EAX,EAX
00701869 JZ 0x00701804
0070186b MOV ECX,EAX
0070186d OR ECX,0x80000000
00701873 CMPXCHG.LOCK dword ptr [RDX],ECX
00701877 JZ 0x00701822
00701879 JMP 0x00701867
00701880 LEA RDI,[R8 + 0x8]
00701884 XOR EAX,EAX
00701886 XCHG dword ptr [RDI],EAX
00701888 TEST AL,0x2
0070188a JZ 0x00701822
0070188c MOV ESI,R9D
0070188f XOR R10D,R10D
00701892 MOV EDX,0x7fffffff
00701897 MOV EAX,0xca
0070189c XOR SIL,0x81
007018a0 SYSCALL
007018a2 CMP RAX,-0x1000
007018a8 JBE 0x00701822
007018ae ADD EAX,0x16
007018b1 AND EAX,0xfffffff7
007018b4 JNZ 0x007017c8
007018ba JMP 0x00701822
