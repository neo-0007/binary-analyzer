00420fd0 ENDBR64
00420fd4 MOV R8,RBX
00420fd7 XOR EAX,EAX
00420fd9 MOV qword ptr [RDI + 0x8],RAX
00420fdd CPUID
00420fdf MOV R11D,EAX
00420fe2 XOR EAX,EAX
00420fe4 CMP EBX,0x756e6547
00420fea SETNZ AL
00420fed MOV R9D,EAX
00420ff0 CMP EDX,0x49656e69
00420ff6 SETNZ AL
00420ff9 OR R9D,EAX
00420ffc CMP ECX,0x6c65746e
00421002 SETNZ AL
00421005 OR R9D,EAX
00421008 JZ 0x00421095
0042100e CMP EBX,0x68747541
00421014 SETNZ AL
00421017 MOV R10D,EAX
0042101a CMP EDX,0x69746e65
00421020 SETNZ AL
00421023 OR R10D,EAX
00421026 CMP ECX,0x444d4163
0042102c SETNZ AL
0042102f OR R10D,EAX
00421032 JNZ 0x00421095
00421034 MOV EAX,0x80000000
00421039 CPUID
0042103b CMP EAX,0x80000001
00421040 JC 0x00421095
00421042 MOV R10D,EAX
00421045 MOV EAX,0x80000001
0042104a CPUID
0042104c OR R9D,ECX
0042104f AND R9D,0x801
00421056 CMP R10D,0x80000008
0042105d JC 0x00421095
0042105f MOV EAX,0x80000008
00421064 CPUID
00421066 MOVZX R10,CL
0042106a INC R10
0042106d MOV EAX,0x1
00421072 CPUID
00421074 BT EDX,0x1c
00421078 JNC 0x0042112a
0042107e SHR EBX,0x10
00421081 CMP BL,R10B
00421084 JA 0x0042112a
0042108a AND EDX,0xefffffff
00421090 JMP 0x0042112a
00421095 CMP R11D,0x4
00421099 MOV R10D,0xffffffff
0042109f JC 0x004210bb
004210a1 MOV EAX,0x4
004210a6 MOV ECX,0x0
004210ab CPUID
004210ad MOV R10D,EAX
004210b0 SHR R10D,0xe
004210b4 AND R10D,0xfff
004210bb MOV EAX,0x1
004210c0 CPUID
004210c2 MOVD XMM0,EAX
004210c6 AND EDX,0xbfefffff
004210cc CMP R9D,0x0
004210d0 JNZ 0x00421104
004210d2 OR EDX,0x40000000
004210d8 AND AH,0xf
004210db CMP AH,0xf
004210de JNZ 0x004210e6
004210e0 OR EDX,0x100000
004210e6 CMP AH,0x6
004210e9 JNZ 0x00421104
004210eb AND EAX,0xfff0ff0
004210f0 CMP EAX,0x50670
004210f5 JZ 0x004210fe
004210f7 CMP EAX,0x80650
004210fc JNZ 0x00421104
004210fe AND ECX,0xfbffffff
00421104 BT EDX,0x1c
00421108 JNC 0x0042112a
0042110a AND EDX,0xefffffff
00421110 CMP R10D,0x0
00421114 JZ 0x0042112a
00421116 OR EDX,0x10000000
0042111c SHR EBX,0x10
0042111f CMP BL,0x1
00421122 JA 0x0042112a
00421124 AND EDX,0xefffffff
0042112a AND R9D,0x800
00421131 AND ECX,0xfffff7ff
00421137 OR R9D,ECX
0042113a MOV R10D,EDX
0042113d CMP R11D,0x7
00421141 JC 0x00421175
00421143 MOV EAX,0x7
00421148 XOR ECX,ECX
0042114a CPUID
0042114c BT R9D,0x1a
00421151 JC 0x00421159
00421153 AND EBX,0xfff7ffff
00421159 MOVD EAX,XMM0
0042115d AND EAX,0xfff0ff0
00421162 CMP EAX,0x50650
00421167 JNZ 0x0042116f
00421169 AND EBX,0xfffeffff
0042116f MOV dword ptr [RDI + 0x8],EBX
00421172 MOV dword ptr [RDI + 0xc],ECX
00421175 BT R9D,0x1b
0042117a JNC 0x0042119c
0042117c XOR ECX,ECX
0042117e XGETBV
00421181 AND EAX,0xe6
00421186 CMP EAX,0xe6
0042118b JZ 0x004211ac
0042118d AND dword ptr [RDI + 0x8],0x3fdeffff
00421194 AND EAX,0x6
00421197 CMP EAX,0x6
0042119a JZ 0x004211ac
0042119c MOV EAX,0xefffe7ff
004211a1 AND R9D,EAX
004211a4 MOV EAX,0x3fdeffdf
004211a9 AND dword ptr [RDI + 0x8],EAX
004211ac SHL R9,0x20
004211b0 MOV EAX,R10D
004211b3 MOV RBX,R8
004211b6 OR RAX,R9
004211b9 RET
