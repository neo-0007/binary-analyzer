007981b0 ENDBR64
007981b4 PUSH R12
007981b6 PUSH RBP
007981b7 MOV RBP,RSI
007981ba PUSH RBX
007981bb MOV EAX,dword ptr [RDI]
007981bd MOV RBX,RDI
007981c0 AND EAX,0x8000
007981c5 JNZ 0x007981fb
007981c7 MOV R12,qword ptr FS:[0x10]
007981d0 MOV RDI,qword ptr [RDI + 0x88]
007981d7 CMP qword ptr [RDI + 0x8],R12
007981db JZ 0x007981f7
007981dd MOV EDX,0x1
007981e2 CMPXCHG.LOCK dword ptr [RDI],EDX
007981e6 JNZ 0x007982a0
007981ec MOV RDI,qword ptr [RBX + 0x88]
007981f3 MOV qword ptr [RDI + 0x8],R12
007981f7 ADD dword ptr [RDI + 0x4],0x1
007981fb MOV RSI,qword ptr [RBP]
007981ff MOV EDX,0x3
00798204 MOV RDI,RBX
00798207 CALL 0x00798490
0079820c CMP RAX,-0x1
00798210 JZ 0x00798278
00798212 MOV EAX,dword ptr [RBX + 0xc0]
00798218 TEST EAX,EAX
0079821a JG 0x00798250
0079821c XOR R12D,R12D
0079821f TEST dword ptr [RBX],0x8000
00798225 JNZ 0x00798248
00798227 MOV RDI,qword ptr [RBX + 0x88]
0079822e MOV EAX,dword ptr [RDI + 0x4]
00798231 SUB EAX,0x1
00798234 MOV dword ptr [RDI + 0x4],EAX
00798237 JNZ 0x00798248
00798239 MOV qword ptr [RDI + 0x8],0x0
00798241 XCHG dword ptr [RDI],EAX
00798243 CMP EAX,0x1
00798246 JG 0x00798298
00798248 MOV EAX,R12D
0079824b POP RBX
0079824c POP RBP
0079824d POP R12
0079824f RET
00798250 MOV RDI,qword ptr [RBX + 0x98]
00798257 CALL 0x006f85a0
0079825c TEST EAX,EAX
0079825e JNS 0x0079821c
00798260 MOV RAX,qword ptr [RBX + 0xa0]
00798267 MOV RDX,qword ptr [RBP + 0x8]
0079826b MOV qword ptr [RAX + 0x58],RDX
0079826f JMP 0x0079821c
00798278 MOV RAX,-0x58
0079827f MOV R12D,0xffffffff
00798285 MOV EDX,dword ptr FS:[RAX]
00798288 TEST EDX,EDX
0079828a JNZ 0x0079821f
0079828c MOV dword ptr FS:[RAX],0x5
00798293 JMP 0x0079821f
00798298 CALL 0x006ffc50
0079829d JMP 0x00798248
007982a0 CALL 0x006ffb80
007982a5 JMP 0x007981ec
