0040b640 ENDBR64
0040b644 TEST RDI,RDI
0040b647 JZ 0x0040b650
0040b649 MOV EAX,dword ptr [RDI + 0x18]
0040b64c TEST EAX,EAX
0040b64e JZ 0x0040b658
0040b650 RET
0040b658 MOV EAX,0xffffffff
0040b65d XADD.LOCK dword ptr [RDI + 0x80],EAX
0040b665 SUB EAX,0x1
0040b668 TEST EAX,EAX
0040b66a JZ 0x0040b678
0040b66c JG 0x0040b650
0040b66e JMP 0x0040b5e0
0040b678 JMP 0x0040b5e0
